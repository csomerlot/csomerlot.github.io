<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Computer Projects">

<title>Computer Projects</title>

<!-- Bootstrap style: bootstrap_blue -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_bootstrap/css/bootstrap_blue.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap_blue */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Robotics Club Setup', 1, None, '___sec0'),
              ('Home Internet Gateway', 1, None, '___sec1'),
              ('Arduino Wind Instrument', 1, None, '___sec2'),
              ('Motocomms', 1, None, '___sec3'),
              ('Track GDD', 1, None, '___sec4'),
              ('Tartan designer', 1, None, '___sec5'),
              ('Somerlot Shooting Support System (S4)', 1, None, '___sec6'),
              ('Retail support tools', 1, None, '___sec7'),
              ('Scheduler', 2, None, '___sec8'),
              ('Rewards Program Calculator', 2, None, '___sec9'),
              ('Common Mobile Compute Platform', 1, None, '___sec10'),
              ('Domotics', 1, None, '___sec11'),
              ('Automotive Media System', 1, None, '___sec12'),
              ('GPS Chartplotter', 1, None, '___sec13'),
              ('Common Sensor and Datalogger Platform', 1, None, '___sec14'),
              ('Micro Hydroponics', 1, None, '___sec15'),
              ('Technology as Art', 1, None, '___sec16'),
              ('Wood Burning Plotter', 2, None, '___sec17'),
              ('Lightning Catcher', 2, None, '___sec18'),
              ('Irrigation Remote', 1, None, '___sec19'),
              ('The Best Damn Radio System', 1, None, '___sec20'),
              ('Fixed Wing UAV', 1, None, '___sec21'),
              ('Autonomous Underwater Vehicle', 1, None, '___sec22'),
              ('Pool Octobot', 1, None, '___sec23'),
              ('Scarecrow Targeting System', 1, None, '___sec24'),
              ('Invasive Species Patroller', 1, None, '___sec25'),
              ('Signal-Tracking Antenna Mount', 1, None, '___sec26'),
              ('CAM Maker Frame', 1, None, '___sec27')]}
end of tocinfo -->

<body>

    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="ComputerProjects.html">Computer Projects</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="ComputerProjects020.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects001.html#___sec0" style="font-size: 80%;"><b>Robotics Club Setup</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects002.html#___sec1" style="font-size: 80%;"><b>Home Internet Gateway</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects003.html#___sec2" style="font-size: 80%;"><b>Arduino Wind Instrument</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects004.html#___sec3" style="font-size: 80%;"><b>Motocomms</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects005.html#___sec4" style="font-size: 80%;"><b>Track GDD</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects006.html#___sec5" style="font-size: 80%;"><b>Tartan designer</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects007.html#___sec6" style="font-size: 80%;"><b>Somerlot Shooting Support System (S4)</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects008.html#___sec7" style="font-size: 80%;"><b>Retail support tools</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects008.html#___sec8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Scheduler</a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects008.html#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Rewards Program Calculator</a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects010.html#___sec10" style="font-size: 80%;"><b>Common Mobile Compute Platform</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects011.html#___sec11" style="font-size: 80%;"><b>Domotics</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects012.html#___sec12" style="font-size: 80%;"><b>Automotive Media System</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects013.html#___sec13" style="font-size: 80%;"><b>GPS Chartplotter</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects014.html#___sec14" style="font-size: 80%;"><b>Common Sensor and Datalogger Platform</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec15" style="font-size: 80%;"><b>Micro Hydroponics</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects016.html#___sec16" style="font-size: 80%;"><b>Technology as Art</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects016.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Wood Burning Plotter</a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects016.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Lightning Catcher</a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects017.html#___sec19" style="font-size: 80%;"><b>Irrigation Remote</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects018.html#___sec20" style="font-size: 80%;"><b>The Best Damn Radio System</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects021.html#___sec21" style="font-size: 80%;"><b>Fixed Wing UAV</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects022.html#___sec22" style="font-size: 80%;"><b>Autonomous Underwater Vehicle</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects023.html#___sec23" style="font-size: 80%;"><b>Pool Octobot</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects024.html#___sec24" style="font-size: 80%;"><b>Scarecrow Targeting System</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects025.html#___sec25" style="font-size: 80%;"><b>Invasive Species Patroller</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects025.html#___sec26" style="font-size: 80%;"><b>Signal-Tracking Antenna Mount</b></a></li>
     <!-- navigation toc: --> <li><a href="ComputerProjects025.html#___sec27" style="font-size: 80%;"><b>CAM Maker Frame</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0015"></a>
<!-- !split -->

<h1 id="___sec15" class="anchor">Micro Hydroponics </h1>
<b>Description:</b>
Small air pump-based flood irrigation system for office plants

<p>
<b>User Story:</b>
Offices are great places for plants, with ample windows and beneficial effects for workers. But, regular watering can be an issue.

<p>
<b>Feature Set:</b>

<ol>
<li> Flood-based system of irrigation with emergency overflow

<ol type="a"></li>
   <li> Air pump inflates bladder, raises solution level, opens ARV to deflate and drop level</li>
   <li> 16" max head = 0.6 PSI</li>
</ol>

<li> Planting cells to allow co-planting but easy replacement/management

<ol type="a"></li>
   <li> Pre-made rock wool blocks available locally</li>
</ol>

<li> 14 day hands-off and quiet operation

<ol type="a"></li>
   <li> Water uptake/usage increases air volume needed to achieve same fluid level, requiring level sensors</li>
</ol>

<li> Water level and quality sensors, media moisture for SmartUtility demonstration via dashboard

<ol type="a"></li>
   <li> Water and energy usage, solution level and nutrient strength</li>
   <li> Back-calculate media moisture based on the timing of flooding and the drain-back volume?</li>
</ol>

<li> Low voltage and redundant level sensor

<ol type="a"></li>
   <li> Pressure sensor for full range and eTape for top 12"</li>
</ol>

<li> Attractive as office decor</li>
</ol>

<b>Phasing:</b>

<ol>
<li> Build sensor and ARV mechanicals

<ol type="a"></li>
   <li> Mount tape and air feed and pressure feed to stick, with ARV and pressure sensor at top</li>
   <li> Assemble microcontroller</li>
   <li> Assemble relay-integrated power supply</li>
</ol>

<li> Install base controller logic</li>
<li> Build server script that runs flood routine based on MQTT events

<ol type="a"></li>
   <li> Make a dashboard interface in <a href="https://learn.adafruit.com/making-a-pyportal-user-interface-displayio?view=all" target="_self">DisplayIO</a></li>
</ol>

<li> Build flood tank with rock wool planting cells</li>
<li> triple-tote system:

<ol type="a"></li>
   <li> Media tray</li>

<ol>
       <li> Notches in bottom edge for drainage</li>
       <li> Anchoring for rock wool cubes

<ol type="a"></li>
           <li> brass screws along rim, to strech rubber bands over?</li>
</ol>

</ol>

   <li> Solution tank</li>

<ol>
       <li> Air line running into 1 large ballon

<ol type="a"></li>
         <li> multiple balloons make multiple points of failure, plus don't inflate equally</li>
</ol>

       <li> Latch media tray in place to avoid flotation</li>
       <li> Thru-hole for overflow port</li>
</ol>

   <li> Overflow tank</li>

<ol>
       <li> Captures leaks or overflows</li>
       <li> Removal with handle for general purpose use</li>
</ol>

</ol>

<li> Open-top cabinet on casters to hold everything and make pretty</li>
</ol>

<b>BOM:</b>

<ul>
<li> <a href="https://www.adafruit.com/product/4116" target="_self">Adafruit PyPortal</a></li>
<li> <a href="https://www.adafruit.com/product/464" target="_self">12in Chemical eTape Liquid Level Sensor</a></li>
<li> <a href="https://www.adafruit.com/product/4663" target="_self">Mini solenoid air valve</a></li>
<li> <a href="https://www.adafruit.com/product/2935" target="_self">Controllable Four Outlet Power Relay Module version 2</a></li>
<li> Separate 5v 1.5A power supply for solenoid and connectors to</li> 
<li> <a href="https://www.sunsethydro.com/collections/growing-media/products/grodan-delta-hugo-6in-block-6in-x-6in-x-6in-w-hole-individual-single-blocks" target="_self">growing media</a></li>
<li> <a href="https://www.truevalue.com/latch-carry-tote-clear-base-18-gallons" target="_self">totes</a></li>
<li> <a href="https://www.digikey.com/product-detail/en/nxp-usa-inc/MPVZ5004GW7U/MPVZ5004GW7U-ND/1168374" target="_self">MPVZ5004GW PRESSURE SENSOR by NXP</a></li>
<li> Silicone tubing</li>
</ul>

<b>Notes:</b>

<ul>
<li> <a href="https://learn.adafruit.com/adafruit-pyportal/overview" target="_self"><tt>https://learn.adafruit.com/adafruit-pyportal/overview</tt></a></li>
<li> Needs some type of anchoring for media in top container for replacing plants and rock wool easily</li>
<li> Flood chamber must be securely anchored against flotation</li>
<li> <a href="./PlantWaterer/PlantWaterer.html" target="_self">First iteration</a> of the design was a simple Trinket-based timer that controlled a <a href="https://www.adafruit.com/product/1150" target="_self">mini peristaltic pump</a>. It worked if the water source was elevated to deal with the limits of the pump curve.</li>
</ul>

<b>Logic:</b>

<ol>
<li> Start flood event:

<ol type="a"></li>
   <li> turn on air pump and close air release valve for until level has stabilized to within 0.25" for 5 minutes</li>

<ol>
       <li> Report solution level from both sensors every 15 seconds</li>
</ol>

   <li> if it has been more than 20 minutes, terminate on cycle and alert</li>
   <li> if water detected in overflow tank, terminate on cycle and alert</li>
   <li> if sensors do not agree on level, alert</li>
   <li> if solution level falls below 3", alert</li>
</ol>

<li> Alert:

<ol type="a"></li>
   <li> flash the built-in light</li>
   <li> play noise</li>
   <li> send text message</li>
</ol>

</ol>

<b>CODE:</b>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #3D7B7B; font-style: italic"># SPDX-FileCopyrightText: 2020 Richard Albritton for Adafruit Industries</span>
<span style="color: #3D7B7B; font-style: italic">#</span>
<span style="color: #3D7B7B; font-style: italic"># SPDX-License-Identifier: MIT</span>
<span style="color: #3D7B7B; font-style: italic">#</span>
<span style="color: #3D7B7B; font-style: italic"># https://learn.adafruit.com/making-a-pyportal-user-interface-displayio?view=all</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">os</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">time</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">board</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">microcontroller</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">displayio</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">busio</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">analogio</span> <span style="color: #008000; font-weight: bold">import</span> AnalogIn
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">neopixel</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">adafruit_adt7410</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">adafruit_bitmap_font</span> <span style="color: #008000; font-weight: bold">import</span> bitmap_font
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">adafruit_display_text.label</span> <span style="color: #008000; font-weight: bold">import</span> Label
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">adafruit_button</span> <span style="color: #008000; font-weight: bold">import</span> Button
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">adafruit_touchscreen</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">adafruit_pyportal</span> <span style="color: #008000; font-weight: bold">import</span> PyPortal

<span style="color: #3D7B7B; font-style: italic"># ------------- Constants ------------- #</span>
<span style="color: #3D7B7B; font-style: italic"># Sound Effects</span>
soundDemo <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;/sounds/sound.wav&quot;</span>
soundBeep <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;/sounds/beep.wav&quot;</span>
soundTab <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;/sounds/tab.wav&quot;</span>

<span style="color: #3D7B7B; font-style: italic"># Hex Colors</span>
WHITE <span style="color: #666666">=</span> <span style="color: #666666">0xFFFFFF</span>
RED <span style="color: #666666">=</span> <span style="color: #666666">0xFF0000</span>
YELLOW <span style="color: #666666">=</span> <span style="color: #666666">0xFFFF00</span>
GREEN <span style="color: #666666">=</span> <span style="color: #666666">0x00FF00</span>
BLUE <span style="color: #666666">=</span> <span style="color: #666666">0x0000FF</span>
PURPLE <span style="color: #666666">=</span> <span style="color: #666666">0xFF00FF</span>
BLACK <span style="color: #666666">=</span> <span style="color: #666666">0x000000</span>

<span style="color: #3D7B7B; font-style: italic"># Default Label styling</span>
TABS_X <span style="color: #666666">=</span> <span style="color: #666666">8</span>
TABS_Y <span style="color: #666666">=</span> <span style="color: #666666">15</span>
TABS_chars <span style="color: #666666">=</span> <span style="color: #666666">40</span>

<span style="color: #3D7B7B; font-style: italic"># Default button styling:</span>
BUTTON_HEIGHT <span style="color: #666666">=</span> <span style="color: #666666">40</span>
BUTTON_WIDTH <span style="color: #666666">=</span> <span style="color: #666666">132</span>

<span style="color: #3D7B7B; font-style: italic"># Default State</span>
view_live <span style="color: #666666">=</span> <span style="color: #666666">1</span>
button_mode <span style="color: #666666">=</span> <span style="color: #666666">1</span>
flood_state <span style="color: #666666">=</span> <span style="color: #666666">0</span>

<span style="color: #3D7B7B; font-style: italic"># ------------- Functions ------------- #</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">flood</span>():
    <span style="color: #008000; font-weight: bold">global</span> flood_state
    <span style="color: #008000; font-weight: bold">if</span> flood_state:
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Turning off the flood&quot;</span>)
        flood_state <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Starting the flood mechanism&quot;</span>)
        flood_state <span style="color: #666666">=</span> <span style="color: #666666">1</span>

<span style="color: #3D7B7B; font-style: italic"># Backlight function</span>
<span style="color: #3D7B7B; font-style: italic"># Value between 0 and 1 where 0 is OFF, 0.5 is 50% and 1 is 100% brightness.</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_backlight</span>(val):
    val <span style="color: #666666">=</span> <span style="color: #008000">max</span>(<span style="color: #666666">0</span>, <span style="color: #008000">min</span>(<span style="color: #666666">1.0</span>, val))
    <span style="color: #008000; font-weight: bold">try</span>:
        board<span style="color: #666666">.</span>DISPLAY<span style="color: #666666">.</span>auto_brightness <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
    <span style="color: #008000; font-weight: bold">except</span> <span style="color: #CB3F38; font-weight: bold">AttributeError</span>:
        <span style="color: #008000; font-weight: bold">pass</span>
    board<span style="color: #666666">.</span>DISPLAY<span style="color: #666666">.</span>brightness <span style="color: #666666">=</span> val


<span style="color: #3D7B7B; font-style: italic"># Helper for cycling through a number set of 1 to x.</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">numberUP</span>(num, max_val):
    num <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">if</span> num <span style="color: #666666">&lt;=</span> max_val:
        <span style="color: #008000; font-weight: bold">return</span> num
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">1</span>


<span style="color: #3D7B7B; font-style: italic"># Set visibility of layer</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">layerVisibility</span>(state, layer, target):
    <span style="color: #008000; font-weight: bold">try</span>:
        <span style="color: #008000; font-weight: bold">if</span> state <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;show&quot;</span>:
            time<span style="color: #666666">.</span>sleep(<span style="color: #666666">0.1</span>)
            layer<span style="color: #666666">.</span>append(target)
        <span style="color: #008000; font-weight: bold">elif</span> state <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;hide&quot;</span>:
            layer<span style="color: #666666">.</span>remove(target)
    <span style="color: #008000; font-weight: bold">except</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>:
        <span style="color: #008000; font-weight: bold">pass</span>


<span style="color: #3D7B7B; font-style: italic"># This will handle switching Images and Icons</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_image</span>(group, filename):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Set the image file for a given goup for display.</span>
<span style="color: #BA2121; font-style: italic">    This is most useful for Icons or image slideshows.</span>
<span style="color: #BA2121; font-style: italic">        :param group: The chosen group</span>
<span style="color: #BA2121; font-style: italic">        :param filename: The filename of the chosen image</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Set image to &quot;</span>, filename)
    <span style="color: #008000; font-weight: bold">if</span> group:
        group<span style="color: #666666">.</span>pop()

    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> filename:
        <span style="color: #008000; font-weight: bold">return</span>  <span style="color: #3D7B7B; font-style: italic"># we&#39;re done, no icon desired</span>

    <span style="color: #3D7B7B; font-style: italic"># CircuitPython 6 &amp; 7 compatible</span>
    image_file <span style="color: #666666">=</span> <span style="color: #008000">open</span>(filename, <span style="color: #BA2121">&quot;rb&quot;</span>)
    image <span style="color: #666666">=</span> displayio<span style="color: #666666">.</span>OnDiskBitmap(image_file)
    image_sprite <span style="color: #666666">=</span> displayio<span style="color: #666666">.</span>TileGrid(
        image, pixel_shader<span style="color: #666666">=</span><span style="color: #008000">getattr</span>(image, <span style="color: #BA2121">&quot;pixel_shader&quot;</span>, displayio<span style="color: #666666">.</span>ColorConverter())
    )

    <span style="color: #3D7B7B; font-style: italic"># # CircuitPython 7+ compatible</span>
    <span style="color: #3D7B7B; font-style: italic"># image = displayio.OnDiskBitmap(filename)</span>
    <span style="color: #3D7B7B; font-style: italic"># image_sprite = displayio.TileGrid(image, pixel_shader=image.pixel_shader)</span>

    group<span style="color: #666666">.</span>append(image_sprite)


<span style="color: #3D7B7B; font-style: italic"># return a reformatted string with word wrapping using PyPortal.wrap_nicely</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">text_box</span>(target, top, string, max_chars<span style="color: #666666">=</span>TABS_chars):
    text <span style="color: #666666">=</span> pyportal<span style="color: #666666">.</span>wrap_nicely(string, max_chars)
    new_text <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;</span>
    test <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;</span>

    <span style="color: #008000; font-weight: bold">for</span> w <span style="color: #AA22FF; font-weight: bold">in</span> text:
        new_text <span style="color: #666666">+=</span> <span style="color: #BA2121">&quot;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">+</span> w
        test <span style="color: #666666">+=</span> <span style="color: #BA2121">&quot;M</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span>

    text_height <span style="color: #666666">=</span> Label(font, text<span style="color: #666666">=</span><span style="color: #BA2121">&quot;M&quot;</span>, color<span style="color: #666666">=0x03AD31</span>)
    text_height<span style="color: #666666">.</span>text <span style="color: #666666">=</span> test  <span style="color: #3D7B7B; font-style: italic"># Odd things happen without this</span>
    glyph_box <span style="color: #666666">=</span> text_height<span style="color: #666666">.</span>bounding_box
    target<span style="color: #666666">.</span>text <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;</span>  <span style="color: #3D7B7B; font-style: italic"># Odd things happen without this</span>
    target<span style="color: #666666">.</span>y <span style="color: #666666">=</span> <span style="color: #008000">int</span>(glyph_box[<span style="color: #666666">3</span>] <span style="color: #666666">/</span> <span style="color: #666666">2</span>) <span style="color: #666666">+</span> top
    target<span style="color: #666666">.</span>text <span style="color: #666666">=</span> new_text


<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_Temperature</span>(source):
    <span style="color: #008000; font-weight: bold">if</span> source:  <span style="color: #3D7B7B; font-style: italic"># Only if we have the temperature sensor</span>
        celsius <span style="color: #666666">=</span> source<span style="color: #666666">.</span>temperature
    <span style="color: #008000; font-weight: bold">else</span>:  <span style="color: #3D7B7B; font-style: italic"># No temperature sensor</span>
        celsius <span style="color: #666666">=</span> microcontroller<span style="color: #666666">.</span>cpu<span style="color: #666666">.</span>temperature
    <span style="color: #008000; font-weight: bold">return</span> (celsius <span style="color: #666666">*</span> <span style="color: #666666">1.8</span>) <span style="color: #666666">+</span> <span style="color: #666666">32</span>

<span style="color: #3D7B7B; font-style: italic"># ------------- Inputs and Outputs Setup ------------- #</span>
light_sensor <span style="color: #666666">=</span> AnalogIn(board<span style="color: #666666">.</span>LIGHT)
<span style="color: #008000; font-weight: bold">try</span>:
    <span style="color: #3D7B7B; font-style: italic"># attempt to init. the temperature sensor</span>
    i2c_bus <span style="color: #666666">=</span> busio<span style="color: #666666">.</span>I2C(board<span style="color: #666666">.</span>SCL, board<span style="color: #666666">.</span>SDA)
    adt <span style="color: #666666">=</span> adafruit_adt7410<span style="color: #666666">.</span>ADT7410(i2c_bus, address<span style="color: #666666">=0x48</span>)
    adt<span style="color: #666666">.</span>high_resolution <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
<span style="color: #008000; font-weight: bold">except</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>:
    <span style="color: #3D7B7B; font-style: italic"># Did not find ADT7410. Probably running on Titano or Pynt</span>
    adt <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

<span style="color: #3D7B7B; font-style: italic"># ------------- Screen Setup ------------- #</span>
pyportal <span style="color: #666666">=</span> PyPortal()
pyportal<span style="color: #666666">.</span>set_background(<span style="color: #BA2121">&quot;/images/loading.bmp&quot;</span>)  <span style="color: #3D7B7B; font-style: italic"># Display an image until the loop starts</span>
pixel <span style="color: #666666">=</span> neopixel<span style="color: #666666">.</span>NeoPixel(board<span style="color: #666666">.</span>NEOPIXEL, <span style="color: #666666">1</span>, brightness<span style="color: #666666">=1</span>)

<span style="color: #3D7B7B; font-style: italic"># Touchscreen setup  [ Rotate 270 ]</span>
display <span style="color: #666666">=</span> board<span style="color: #666666">.</span>DISPLAY
display<span style="color: #666666">.</span>rotation <span style="color: #666666">=</span> <span style="color: #666666">0</span>

<span style="color: #008000; font-weight: bold">if</span> board<span style="color: #666666">.</span>board_id <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;pyportal_titano&quot;</span>:
    screen_width <span style="color: #666666">=</span> <span style="color: #666666">320</span>
    screen_height <span style="color: #666666">=</span> <span style="color: #666666">480</span>
    set_backlight(
        <span style="color: #666666">1</span>
    )  <span style="color: #3D7B7B; font-style: italic"># 0.3 brightness does not cause the display to be visible on the Titano</span>
<span style="color: #008000; font-weight: bold">else</span>:
    screen_width <span style="color: #666666">=</span> <span style="color: #666666">320</span>
    screen_height <span style="color: #666666">=</span> <span style="color: #666666">240</span>
    set_backlight(<span style="color: #666666">0.3</span>)

<span style="color: #3D7B7B; font-style: italic"># We want three buttons across the top of the screen</span>
TAB_BUTTON_Y <span style="color: #666666">=</span> <span style="color: #666666">0</span>
TAB_BUTTON_HEIGHT <span style="color: #666666">=</span> <span style="color: #666666">40</span>
TAB_BUTTON_WIDTH <span style="color: #666666">=</span> <span style="color: #008000">int</span>(screen_width <span style="color: #666666">/</span> <span style="color: #666666">3</span>)

<span style="color: #3D7B7B; font-style: italic"># We want two big buttons at the bottom of the screen</span>
<span style="color: #3D7B7B; font-style: italic"># BIG_BUTTON_HEIGHT = int(screen_height / 3.2)</span>
<span style="color: #3D7B7B; font-style: italic"># BIG_BUTTON_WIDTH = int(screen_width / 2)</span>
<span style="color: #3D7B7B; font-style: italic"># BIG_BUTTON_Y = int(screen_height - BIG_BUTTON_HEIGHT)</span>

<span style="color: #3D7B7B; font-style: italic"># Initializes the display touch screen area</span>
ts <span style="color: #666666">=</span> adafruit_touchscreen<span style="color: #666666">.</span>Touchscreen(
    board<span style="color: #666666">.</span>TOUCH_XL,
    board<span style="color: #666666">.</span>TOUCH_XR,
    board<span style="color: #666666">.</span>TOUCH_YD,
    board<span style="color: #666666">.</span>TOUCH_YU,
    calibration<span style="color: #666666">=</span>((<span style="color: #666666">5200</span>, <span style="color: #666666">59000</span>), (<span style="color: #666666">5800</span>, <span style="color: #666666">57000</span>)),
    size<span style="color: #666666">=</span>(screen_width, screen_height)
)

<span style="color: #3D7B7B; font-style: italic"># ------------- Display Groups ------------- #</span>
splash <span style="color: #666666">=</span> displayio<span style="color: #666666">.</span>Group()  <span style="color: #3D7B7B; font-style: italic"># The Main Display Group</span>
viewStatus <span style="color: #666666">=</span> displayio<span style="color: #666666">.</span>Group()  <span style="color: #3D7B7B; font-style: italic"># Group for Status objects</span>
viewGraph <span style="color: #666666">=</span> displayio<span style="color: #666666">.</span>Group()  <span style="color: #3D7B7B; font-style: italic"># Group for Graph objects</span>
viewLog <span style="color: #666666">=</span> displayio<span style="color: #666666">.</span>Group()  <span style="color: #3D7B7B; font-style: italic"># Group for Log objects</span>

<span style="color: #3D7B7B; font-style: italic"># ------------- Setup for Images ------------- #</span>
bg_group <span style="color: #666666">=</span> displayio<span style="color: #666666">.</span>Group()
splash<span style="color: #666666">.</span>append(bg_group)
set_image(bg_group, <span style="color: #BA2121">&quot;/images/BGimage.bmp&quot;</span>)

icon_group <span style="color: #666666">=</span> displayio<span style="color: #666666">.</span>Group()
icon_group<span style="color: #666666">.</span>x <span style="color: #666666">=</span> <span style="color: #666666">180</span>
icon_group<span style="color: #666666">.</span>y <span style="color: #666666">=</span> <span style="color: #666666">120</span>
icon_group<span style="color: #666666">.</span>scale <span style="color: #666666">=</span> <span style="color: #666666">1</span>
viewGraph<span style="color: #666666">.</span>append(icon_group)

<span style="color: #3D7B7B; font-style: italic"># ---------- Text Boxes ------------- #</span>
<span style="color: #3D7B7B; font-style: italic"># Set the font and preload letters</span>
font <span style="color: #666666">=</span> bitmap_font<span style="color: #666666">.</span>load_font(<span style="color: #BA2121">&quot;/fonts/Helvetica-Bold-16.bdf&quot;</span>)
font<span style="color: #666666">.</span>load_glyphs(<span style="color: #BA2121">b&quot;abcdefghjiklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890- ()&quot;</span>)

<span style="color: #3D7B7B; font-style: italic"># Text Label Objects</span>
feed1_label <span style="color: #666666">=</span> Label(font, text<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Text Window 1&quot;</span>, color<span style="color: #666666">=0xE39300</span>)
feed1_label<span style="color: #666666">.</span>x <span style="color: #666666">=</span> TABS_X
feed1_label<span style="color: #666666">.</span>y <span style="color: #666666">=</span> TABS_Y
viewStatus<span style="color: #666666">.</span>append(feed1_label)

sensors_label <span style="color: #666666">=</span> Label(font, text<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Data View&quot;</span>, color<span style="color: #666666">=0x03AD31</span>)
sensors_label<span style="color: #666666">.</span>x <span style="color: #666666">=</span> TABS_X
sensors_label<span style="color: #666666">.</span>y <span style="color: #666666">=</span> TABS_Y <span style="color: #666666">+</span> <span style="color: #666666">50</span>
viewStatus<span style="color: #666666">.</span>append(sensors_label)

sensor_data <span style="color: #666666">=</span> Label(font, text<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Data View&quot;</span>, color<span style="color: #666666">=</span>GREEN)
sensor_data<span style="color: #666666">.</span>x <span style="color: #666666">=</span> TABS_X <span style="color: #666666">+</span> <span style="color: #666666">16</span>  <span style="color: #3D7B7B; font-style: italic"># Indents the text layout</span>
sensor_data<span style="color: #666666">.</span>y <span style="color: #666666">=</span> TABS_Y <span style="color: #666666">+</span> <span style="color: #666666">150</span>
viewStatus<span style="color: #666666">.</span>append(sensor_data)

<span style="color: #3D7B7B; font-style: italic"># ---------- Display Buttons ------------- #</span>
<span style="color: #3D7B7B; font-style: italic"># This group will make it easy for us to read a button press later.</span>
buttons <span style="color: #666666">=</span> []

<span style="color: #3D7B7B; font-style: italic"># Main User Interface Buttons</span>
button_status <span style="color: #666666">=</span> Button(
    x<span style="color: #666666">=0</span>,  <span style="color: #3D7B7B; font-style: italic"># Start at furthest left</span>
    y<span style="color: #666666">=0</span>,  <span style="color: #3D7B7B; font-style: italic"># Start at top</span>
    width<span style="color: #666666">=</span>TAB_BUTTON_WIDTH,  <span style="color: #3D7B7B; font-style: italic"># Calculated width</span>
    height<span style="color: #666666">=</span>TAB_BUTTON_HEIGHT,  <span style="color: #3D7B7B; font-style: italic"># Static height</span>
    label<span style="color: #666666">=</span><span style="color: #BA2121">&quot;STATUS&quot;</span>,
    label_font<span style="color: #666666">=</span>font,
    label_color<span style="color: #666666">=0xFF7E00</span>,
    fill_color<span style="color: #666666">=0x5C5B5C</span>,
    outline_color<span style="color: #666666">=0x767676</span>,
    selected_fill<span style="color: #666666">=0x1A1A1A</span>,
    selected_outline<span style="color: #666666">=0x2E2E2E</span>,
    selected_label<span style="color: #666666">=0x525252</span>,
)
buttons<span style="color: #666666">.</span>append(button_status)  <span style="color: #3D7B7B; font-style: italic"># adding this button to the buttons group</span>

button_graph <span style="color: #666666">=</span> Button(
    x<span style="color: #666666">=</span>TAB_BUTTON_WIDTH,  <span style="color: #3D7B7B; font-style: italic"># Start after width of a button</span>
    y<span style="color: #666666">=0</span>,
    width<span style="color: #666666">=</span>TAB_BUTTON_WIDTH,
    height<span style="color: #666666">=</span>TAB_BUTTON_HEIGHT,
    label<span style="color: #666666">=</span><span style="color: #BA2121">&quot;GRAPH&quot;</span>,
    label_font<span style="color: #666666">=</span>font,
    label_color<span style="color: #666666">=0xFF7E00</span>,
    fill_color<span style="color: #666666">=0x5C5B5C</span>,
    outline_color<span style="color: #666666">=0x767676</span>,
    selected_fill<span style="color: #666666">=0x1A1A1A</span>,
    selected_outline<span style="color: #666666">=0x2E2E2E</span>,
    selected_label<span style="color: #666666">=0x525252</span>,
)
buttons<span style="color: #666666">.</span>append(button_graph)  <span style="color: #3D7B7B; font-style: italic"># adding this button to the buttons group</span>

button_log <span style="color: #666666">=</span> Button(
    x<span style="color: #666666">=</span>TAB_BUTTON_WIDTH <span style="color: #666666">*</span> <span style="color: #666666">2</span>,  <span style="color: #3D7B7B; font-style: italic"># Start after width of 2 buttons</span>
    y<span style="color: #666666">=0</span>,
    width<span style="color: #666666">=</span>TAB_BUTTON_WIDTH,
    height<span style="color: #666666">=</span>TAB_BUTTON_HEIGHT,
    label<span style="color: #666666">=</span><span style="color: #BA2121">&quot;LOG&quot;</span>,
    label_font<span style="color: #666666">=</span>font,
    label_color<span style="color: #666666">=0xFF7E00</span>,
    fill_color<span style="color: #666666">=0x5C5B5C</span>,
    outline_color<span style="color: #666666">=0x767676</span>,
    selected_fill<span style="color: #666666">=0x1A1A1A</span>,
    selected_outline<span style="color: #666666">=0x2E2E2E</span>,
    selected_label<span style="color: #666666">=0x525252</span>,
)
buttons<span style="color: #666666">.</span>append(button_log)  <span style="color: #3D7B7B; font-style: italic"># adding this button to the buttons group</span>

<span style="color: #3D7B7B; font-style: italic"># Add all of the main buttons to the splash Group</span>
<span style="color: #008000; font-weight: bold">for</span> b <span style="color: #AA22FF; font-weight: bold">in</span> buttons:
    splash<span style="color: #666666">.</span>append(b)

<span style="color: #3D7B7B; font-style: italic"># Make a button to play a sound on viewStatus</span>
button_flood <span style="color: #666666">=</span> Button(
    x<span style="color: #666666">=180</span>,
    y<span style="color: #666666">=180</span>,
    width<span style="color: #666666">=</span>BUTTON_WIDTH,
    height<span style="color: #666666">=</span>BUTTON_HEIGHT,
    label<span style="color: #666666">=</span><span style="color: #BA2121">&quot;FLOOD NOW&quot;</span>,
    label_font<span style="color: #666666">=</span>font,
    label_color<span style="color: #666666">=0xFFFFFF</span>,
    fill_color<span style="color: #666666">=0x8900FF</span>,
    outline_color<span style="color: #666666">=0xBC55FD</span>,
    selected_fill<span style="color: #666666">=0x5A5A5A</span>,
    selected_outline<span style="color: #666666">=0xFF6600</span>,
    selected_label<span style="color: #666666">=0x525252</span>,
    style<span style="color: #666666">=</span>Button<span style="color: #666666">.</span>ROUNDRECT,
)
buttons<span style="color: #666666">.</span>append(button_flood)  <span style="color: #3D7B7B; font-style: italic"># adding this button to the buttons group</span>

<span style="color: #3D7B7B; font-style: italic"># Add this button to viewGraph Group</span>
viewStatus<span style="color: #666666">.</span>append(button_flood)

<span style="color: #3D7B7B; font-style: italic"># pylint: disable=global-statement</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">switch_view</span>(what_view):
    <span style="color: #008000; font-weight: bold">global</span> view_live
    <span style="color: #008000; font-weight: bold">if</span> what_view <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
        button_status<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
        button_graph<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
        button_log<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
        layerVisibility(<span style="color: #BA2121">&quot;hide&quot;</span>, splash, viewGraph)
        layerVisibility(<span style="color: #BA2121">&quot;hide&quot;</span>, splash, viewLog)
        layerVisibility(<span style="color: #BA2121">&quot;show&quot;</span>, splash, viewStatus)
    <span style="color: #008000; font-weight: bold">elif</span> what_view <span style="color: #666666">==</span> <span style="color: #666666">2</span>:
        <span style="color: #3D7B7B; font-style: italic"># global icon</span>
        button_status<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
        button_graph<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
        button_log<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
        layerVisibility(<span style="color: #BA2121">&quot;hide&quot;</span>, splash, viewStatus)
        layerVisibility(<span style="color: #BA2121">&quot;hide&quot;</span>, splash, viewLog)
        layerVisibility(<span style="color: #BA2121">&quot;show&quot;</span>, splash, viewGraph)
    <span style="color: #008000; font-weight: bold">else</span>:
        button_status<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
        button_graph<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
        button_log<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
        layerVisibility(<span style="color: #BA2121">&quot;hide&quot;</span>, splash, viewStatus)
        layerVisibility(<span style="color: #BA2121">&quot;hide&quot;</span>, splash, viewGraph)
        layerVisibility(<span style="color: #BA2121">&quot;show&quot;</span>, splash, viewLog)

    <span style="color: #3D7B7B; font-style: italic"># Set global button state</span>
    view_live <span style="color: #666666">=</span> what_view
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;View </span><span style="color: #A45A77; font-weight: bold">{view_num:.0f}</span><span style="color: #BA2121"> On&quot;</span><span style="color: #666666">.</span>format(view_num<span style="color: #666666">=</span>what_view))


<span style="color: #3D7B7B; font-style: italic"># pylint: enable=global-statement</span>

<span style="color: #3D7B7B; font-style: italic"># Set veriables and startup states</span>
button_status<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
button_graph<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
button_log<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>

layerVisibility(<span style="color: #BA2121">&quot;show&quot;</span>, splash, viewStatus)
layerVisibility(<span style="color: #BA2121">&quot;hide&quot;</span>, splash, viewGraph)
layerVisibility(<span style="color: #BA2121">&quot;hide&quot;</span>, splash, viewLog)

<span style="color: #3D7B7B; font-style: italic"># Update out Labels with display text.</span>
text_box(
    feed1_label,
    TABS_Y,
    <span style="color: #BA2121">&quot;This device controls the irrigation of this planter via flood events.&quot;</span>
)

text_box(
    sensors_label,
    TABS_Y <span style="color: #666666">+</span> <span style="color: #666666">90</span>,
    <span style="color: #BA2121">&quot;Sensor readings:&quot;</span>
)

board<span style="color: #666666">.</span>DISPLAY<span style="color: #666666">.</span>show(splash)


<span style="color: #3D7B7B; font-style: italic"># ------------- Code Loop ------------- #</span>
<span style="color: #008000; font-weight: bold">while</span> <span style="color: #008000; font-weight: bold">True</span>:
    touch <span style="color: #666666">=</span> ts<span style="color: #666666">.</span>touch_point
    light <span style="color: #666666">=</span> light_sensor<span style="color: #666666">.</span>value
    sensor_data<span style="color: #666666">.</span>text <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Touch: </span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">Light: </span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">Temp: </span><span style="color: #A45A77; font-weight: bold">{:.0f}</span><span style="color: #BA2121">Â°F&quot;</span><span style="color: #666666">.</span>format(
        touch, light, get_Temperature(adt)
    )

    <span style="color: #3D7B7B; font-style: italic"># Will also cause screen to dim when hand is blocking sensor to touch screen</span>
    <span style="color: #3D7B7B; font-style: italic">#    # Adjust backlight</span>
    <span style="color: #3D7B7B; font-style: italic">#    if light &lt; 1500:</span>
    <span style="color: #3D7B7B; font-style: italic">#        set_backlight(0.1)</span>
    <span style="color: #3D7B7B; font-style: italic">#    elif light &lt; 3000:</span>
    <span style="color: #3D7B7B; font-style: italic">#        set_backlight(0.5)</span>
    <span style="color: #3D7B7B; font-style: italic">#    else:</span>
    <span style="color: #3D7B7B; font-style: italic">#        set_backlight(1)</span>

    <span style="color: #3D7B7B; font-style: italic"># ------------- Handle Button Press Detection  ------------- #</span>
    <span style="color: #008000; font-weight: bold">if</span> touch:  <span style="color: #3D7B7B; font-style: italic"># Only do this if the screen is touched</span>
        <span style="color: #3D7B7B; font-style: italic"># loop with buttons using enumerate() to number each button group as i</span>
        <span style="color: #008000; font-weight: bold">for</span> i, b <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">enumerate</span>(buttons):
            <span style="color: #008000; font-weight: bold">if</span> b<span style="color: #666666">.</span>contains(touch):  <span style="color: #3D7B7B; font-style: italic"># Test each button to see if it was pressed</span>
                <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;button</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121"> pressed&quot;</span><span style="color: #666666">.</span>format(i))
                <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">==</span> <span style="color: #666666">0</span> <span style="color: #AA22FF; font-weight: bold">and</span> view_live <span style="color: #666666">!=</span> <span style="color: #666666">1</span>:  <span style="color: #3D7B7B; font-style: italic"># only if viewStatus is visible</span>
                    pyportal<span style="color: #666666">.</span>play_file(soundTab)
                    switch_view(<span style="color: #666666">1</span>)
                    <span style="color: #008000; font-weight: bold">while</span> ts<span style="color: #666666">.</span>touch_point:
                        <span style="color: #008000; font-weight: bold">pass</span>
                <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">==</span> <span style="color: #666666">1</span> <span style="color: #AA22FF; font-weight: bold">and</span> view_live <span style="color: #666666">!=</span> <span style="color: #666666">2</span>:  <span style="color: #3D7B7B; font-style: italic"># only if viewGraph is visible</span>
                    pyportal<span style="color: #666666">.</span>play_file(soundTab)
                    switch_view(<span style="color: #666666">2</span>)
                    <span style="color: #008000; font-weight: bold">while</span> ts<span style="color: #666666">.</span>touch_point:
                        <span style="color: #008000; font-weight: bold">pass</span>
                <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">==</span> <span style="color: #666666">2</span> <span style="color: #AA22FF; font-weight: bold">and</span> view_live <span style="color: #666666">!=</span> <span style="color: #666666">3</span>:  <span style="color: #3D7B7B; font-style: italic"># only if viewLog is visible</span>
                    pyportal<span style="color: #666666">.</span>play_file(soundTab)
                    switch_view(<span style="color: #666666">3</span>)
                    <span style="color: #008000; font-weight: bold">while</span> ts<span style="color: #666666">.</span>touch_point:
                        <span style="color: #008000; font-weight: bold">pass</span>
                <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">==</span> <span style="color: #666666">3</span>:
                    pyportal<span style="color: #666666">.</span>play_file(soundBeep)
                    <span style="color: #3D7B7B; font-style: italic"># Toggle switch button type</span>
                    flood()
                    <span style="color: #008000; font-weight: bold">if</span> flood_state <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
                        b<span style="color: #666666">.</span>label <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;STOP&quot;</span>
                        b<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
                        b<span style="color: #666666">.</span>label_color <span style="color: #666666">=</span> RED
                        pixel<span style="color: #666666">.</span>fill(WHITE)
                    <span style="color: #008000; font-weight: bold">else</span>:
                        b<span style="color: #666666">.</span>label <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;FLOOD NOW&quot;</span>
                        b<span style="color: #666666">.</span>selected <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
                        b<span style="color: #666666">.</span>label_color <span style="color: #666666">=</span> WHITE
                        pixel<span style="color: #666666">.</span>fill(BLACK)
                        
                        
                    <span style="color: #3D7B7B; font-style: italic"># for debounce</span>
                    <span style="color: #008000; font-weight: bold">while</span> ts<span style="color: #666666">.</span>touch_point:
                        <span style="color: #008000; font-weight: bold">pass</span>
                    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Switch Pressed&quot;</span>)
</pre></div>
<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">

  <li class="previous">
    <a href="ComputerProjects014.html">&larr; Prev</a>
  </li>

  <li class="next">
    <a href="ComputerProjects016.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

