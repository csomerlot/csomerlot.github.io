<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>computerprojects – My Projects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-474c6d7e63be50eb6972897072b39b27.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-0da51def7327ca16711a37584672fa33.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-3d923cdaf6315beb1c25188d9af74325.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">My Projects</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ComputerProjects.html">Computer Projects</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AlternativeEnergyProjects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alternative Energy Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Apiary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">My Apiary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BoatProjects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Boat Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BusinessIdeas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Business Ideas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CampingProjects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Camping Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ComputerProjects.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Computer Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EmergencyPlans.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Emergency Plans</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HappyHippieLifestyleProjects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Happy Hippie Lifestyle Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IoTProjects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Internet-of-Things Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NorthWoodsCottage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">North Woods Cottage</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RoboticsProjects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Robotics Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ShootingProjects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shooting Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TemporaryRetirement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Temporary Retirement</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ThistleRidgeFarmProjects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Thistle Ridge Farm Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./WoodWorking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Traditional Wood Craft</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#computer-projects" id="toc-computer-projects" class="nav-link active" data-scroll-target="#computer-projects">Computer Projects</a>
  <ul class="collapse">
  <li><a href="#robotics-club-setup" id="toc-robotics-club-setup" class="nav-link" data-scroll-target="#robotics-club-setup">Robotics Club Setup</a></li>
  <li><a href="#home-internet-gateway" id="toc-home-internet-gateway" class="nav-link" data-scroll-target="#home-internet-gateway">Home Internet Gateway</a></li>
  <li><a href="#arduino-wind-instrument" id="toc-arduino-wind-instrument" class="nav-link" data-scroll-target="#arduino-wind-instrument">Arduino Wind Instrument</a></li>
  <li><a href="#motocomms" id="toc-motocomms" class="nav-link" data-scroll-target="#motocomms">Motocomms</a></li>
  <li><a href="#track-gdd" id="toc-track-gdd" class="nav-link" data-scroll-target="#track-gdd">Track GDD</a></li>
  <li><a href="#tartan-designer" id="toc-tartan-designer" class="nav-link" data-scroll-target="#tartan-designer">Tartan designer</a></li>
  <li><a href="#somerlot-shooting-support-system-s4" id="toc-somerlot-shooting-support-system-s4" class="nav-link" data-scroll-target="#somerlot-shooting-support-system-s4">Somerlot Shooting Support System (S4)</a></li>
  <li><a href="#retail-support-tools" id="toc-retail-support-tools" class="nav-link" data-scroll-target="#retail-support-tools">Retail support tools</a>
  <ul class="collapse">
  <li><a href="#scheduler" id="toc-scheduler" class="nav-link" data-scroll-target="#scheduler">Scheduler</a></li>
  <li><a href="#rewards-program-calculator" id="toc-rewards-program-calculator" class="nav-link" data-scroll-target="#rewards-program-calculator">Rewards Program Calculator</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="computer-projects" class="level1">
<h1>Computer Projects</h1>
<hr>
<section id="robotics-club-setup" class="level2">
<h2 class="anchored" data-anchor-id="robotics-club-setup">Robotics Club Setup</h2>
<section id="maker-kits" class="level4">
<h4 class="anchored" data-anchor-id="maker-kits">Maker kits:</h4>
<ol type="1">
<li>Tools
<ol type="1">
<li>Build tray/mat (with edges, for roll-y parts)</li>
<li>ESC bracelet</li>
<li>Connector kits (JST PH) and crimpers for making cables</li>
</ol></li>
<li>Parts warehousing
<ol type="1">
<li>Tackle box with baggie system</li>
</ol></li>
<li>Documentation
<ol type="1">
<li>GoPro for video logging</li>
<li>Rocket book</li>
<li>DocOnce</li>
<li>private git server</li>
</ol></li>
<li>Dev Environment
<ol type="1">
<li>Platforms
<ol type="1">
<li>IaaS: AWS Workspace</li>
<li>PaaS: Platform.io</li>
<li>Local: Raspberry Pi</li>
</ol></li>
<li>Software:
<ol type="1">
<li>Fritzing</li>
<li>3D CAD
<ol type="1">
<li>SolidPython (OpenSCAD) (because programming is better)</li>
<li>DesignSpark Mechanical</li>
<li>Opens .skp!</li>
<li>But no linux</li>
</ol></li>
<li><a href="https://www.autodesk.com/campaigns/fusion-360/factory-experience">Autodesk Fusion</a> (but not free)</li>
<li>Blockly</li>
<li>Anaconda Python Env</li>
<li>Atom</li>
</ol></li>
</ol></li>
</ol>
</section>
<section id="projects" class="level4">
<h4 class="anchored" data-anchor-id="projects">Projects:</h4>
<ol type="1">
<li>Init: Individual project options
<ol type="1">
<li>Basic battle bots</li>
<li>Steampunk wearables</li>
<li>Ornaments</li>
</ol></li>
<li>Main Missions: Group effort determined by vote
<ol type="1">
<li>Citizen science</li>
<li>Tech-art integration</li>
</ol></li>
</ol>
</section>
<section id="requirements" class="level4">
<h4 class="anchored" data-anchor-id="requirements">Requirements:</h4>
<ul>
<li>Grades</li>
<li>Portfolio</li>
<li>Teacher recommendation</li>
<li>Behavior</li>
</ul>
</section>
<section id="coding-devenv" class="level4">
<h4 class="anchored" data-anchor-id="coding-devenv">Coding DevEnv:</h4>
<ul>
<li>Visual programming (blockly-scratch-mindstorm)</li>
<li>Individual programming jobs with unit testing</li>
<li>Agile - Kanban - scrum</li>
<li>Arduino Studio must be installed locally, no good browser-based IDE (need to test PlatformIO though)</li>
</ul>
<hr>
</section>
</section>
<section id="home-internet-gateway" class="level2">
<h2 class="anchored" data-anchor-id="home-internet-gateway">Home Internet Gateway</h2>
<section id="description" class="level4">
<h4 class="anchored" data-anchor-id="description">Description:</h4>
<p>Cable modem, IoT gateway, wifi router/repeater, and firewall device.</p>
</section>
<section id="user-story" class="level4">
<h4 class="anchored" data-anchor-id="user-story">User Story:</h4>
<p>I just want the internet to work. I also want to protect my family and house, integrate with Domotics and IoT, and give the internet company their crap hardware back. Maybe I can even eventually dump the internet company completely for community-based wifi or a free-space optical link.</p>
</section>
<section id="feature-set" class="level4">
<h4 class="anchored" data-anchor-id="feature-set">Feature Set:</h4>
<ol type="1">
<li>Parental Filtering and logging</li>
<li>Directional Wifi</li>
<li>Switching between internet sources</li>
<li>Performance and health dashboard</li>
<li>wikipedia and media cache</li>
<li>privacy and ad blocking</li>
<li><a href="https://othernet.is/">Othernet</a> Integration (I <em>so</em> hope this project works)</li>
<li><a href="https://github.com/IRNAS/FSO-systems">FSO link</a></li>
</ol>
</section>
<section id="phasing" class="level4">
<h4 class="anchored" data-anchor-id="phasing">Phasing:</h4>
<ul>
<li>configure basic access point (check functionality after each step)</li>
<li>Basic config shown <a href="https://www.raspberrypi.org/documentation/configuration/wireless/access-point-routed.md">here</a> (first part only) including security (but not ufw firewall) set up shown <a href="https://www.raspberrypi.org/documentation/configuration/security.md">here</a>
<ul>
<li>Use wlan1 instead of on-board wlan0</li>
</ul></li>
<li>Enable <a href="https://lb.raspberrypi.org/forums/viewtopic.php?t=92859">hostapd</a> and <a href="https://www.linux.com/tutorials/advanced-dnsmasq-tips-and-tricks/">dnsmasq</a> logging</li>
<li>Open network via hostapd conf shown <a href="https://elinux.org/RPI-Wireless-Hotspot">here</a></li>
<li><a href="https://serverfault.com/questions/214996/iptables-allow-ssh-access-only-nothing-else-in-or-out">mod iptables to allow ssh in only</a>
<ul>
<li>check with nmap -sS -p 1-65535 <external ip=""></external></li>
</ul></li>
<li>set up sshd with <a href="https://www.cyberciti.biz/tips/linux-unix-bsd-openssh-server-best-practices.html">best practices</a>
<ul>
<li>create a log of sites visited by MAC address</li>
</ul></li>
<li>set up tcpdump to save link headers to <a href="https://www.raspberrypi.org/forums/viewtopic.php?t=237584">MySQL</a> (see code below)</li>
<li>The better option is to use a <a href="https://www.dinofizzotti.com/blog/2019-01-09-running-a-man-in-the-middle-proxy-on-a-raspberry-pi-3/">MITM proxy</a> in transparent mode, but that requires users accepting and installing a certificate</li>
<li>use <a href="https://dash-gallery.plotly.host/dash-oil-and-gas/">dash</a> to create BI reports of traffic</li>
<li>link with <a href="https://code.wireshark.org/review/gitweb?p=wireshark.git;a=blob_plain;f=manuf">MAC dbs</a> and commonly-used domains DB</li>
<li>set up <a href="https://aws.amazon.com/blogs/startups/how-to-build-a-serverless-dynamic-dns-system-with-aws/">Dynamic DNS</a> (see code below)</li>
<li>set up a DNS Sinkhole such as <a href="https://en.wikipedia.org/wiki/Pi-hole">pi-hole</a> or <a href="https://github.com/quidsup/notrack">NoTrack</a> to cut down on ads</li>
<li>use OpenDNS to cut down on phishing and increase DNS lookup speeds (<a href="https://www.raspberrypi.org/forums/viewtopic.php?t=210933">Has to be set up in dnsmasq using option 6</a>)</li>
<li>set up <a href="https://learn.adafruit.com/onion-pi?view=all">tor</a> or a VPN
<ul>
<li>set up config landing page
<ul>
<li>Switch choice of wlan0 or eth0</li>
<li>Tune filters, dyndns, dns sink</li>
<li>Show dash traffic metrics</li>
<li>Show status metrics (by user)</li>
</ul></li>
</ul></li>
<li>swap cable modem</li>
<li>add external storage with media library</li>
<li>install othernet</li>
<li>build FSO tranceivers</li>
<li><a href="https://www.adafruit.com/product/1056">Laser</a> transmitter coupled to a <a href="https://www.adafruit.com/product/2831">photo transister</a> receiver mounted on a <a href="https://www.amazon.com/BARSKA-15-40x50-Colorado-Spotting-Scope/dp/B0049IZMUW/ref=sr_1_16?dchild=1&amp;keywords=spotting+scope&amp;qid=1578058031&amp;sr=8-16">spotting scope</a>, with fiber optic modulators</li>
</ul>
</section>
<section id="bom" class="level4">
<h4 class="anchored" data-anchor-id="bom">BOM:</h4>
<ol type="1">
<li><a href="./._ComputerProjects010.html#___sec10">Common Mobile Compute Platform</a> (two, one for testing, one for production)</li>
</ol>
</section>
<section id="notes" class="level4">
<h4 class="anchored" data-anchor-id="notes">Notes:</h4>
<ul>
<li><a href="https://www.digikey.com/en/articles/techzone/2013/oct/building-free-space-optical-systems" class="uri">https://www.digikey.com/en/articles/techzone/2013/oct/building-free-space-optical-systems</a></li>
<li><a href="http://shop.oreilly.com/product/9780596002046.do" class="uri">http://shop.oreilly.com/product/9780596002046.do</a></li>
</ul>
</section>
<section id="graphics" class="level4">
<h4 class="anchored" data-anchor-id="graphics">GRAPHICS:</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./Programming/AP_Viewshed.png" class="img-fluid figure-img"></p>
<figcaption>Line of sight between office and home.</figcaption>
</figure>
</div>
</section>
<section id="code" class="level4">
<h4 class="anchored" data-anchor-id="code">CODE:</h4>
<p><a href="./code/route53update.py">Link to the DNS code</a></p>
</section>
<section id="code-1" class="level4">
<h4 class="anchored" data-anchor-id="code-1">CODE:</h4>
<p><a href="./code/watcher.py">Link to the watcher code</a></p>
<hr>
</section>
</section>
<section id="arduino-wind-instrument" class="level2">
<h2 class="anchored" data-anchor-id="arduino-wind-instrument">Arduino Wind Instrument</h2>
<section id="description-1" class="level4">
<h4 class="anchored" data-anchor-id="description-1">Description:</h4>
<p>An inexpensive and simple electronic wind instrument to learn digital music programming</p>
</section>
<section id="user-story-1" class="level4">
<h4 class="anchored" data-anchor-id="user-story-1">User Story:</h4>
<p>Real instruments are expensive, and you can only learn to play music…</p>
</section>
<section id="feature-set-1" class="level4">
<h4 class="anchored" data-anchor-id="feature-set-1">Feature Set:</h4>
<ul>
<li>Breath and bite sensors</li>
<li>Sax fingering</li>
<li>Wireless midi port</li>
<li>FOSS full synth with effects</li>
</ul>
</section>
<section id="phasing-1" class="level4">
<h4 class="anchored" data-anchor-id="phasing-1">Phasing:</h4>
<ul>
<li>Pick up an Akai EWI</li>
<li>Make a portable sound system</li>
<li>Pick up the Zynthian kit parts</li>
</ul>
</section>
<section id="bom-1" class="level4">
<h4 class="anchored" data-anchor-id="bom-1">BOM:</h4>
<ul>
<li><a href="https://www.hifiberry.com/products/dacplus/" class="uri">https://www.hifiberry.com/products/dacplus/</a></li>
<li><a href="https://www.amazon.com/BOSS-Audio-CE200M-Monoblock-Amplifier/dp/B0077IA7FG?th=1&amp;psc=1" class="uri">https://www.amazon.com/BOSS-Audio-CE200M-Monoblock-Amplifier/dp/B0077IA7FG?th=1&amp;psc=1</a></li>
<li><a href="https://www.amazon.com/Antigravity-Batteries-Battery-Starter-Charger/dp/B01L0F6K5C/ref=pd_aw_vtph_263_lp_tr_2/130-0236497-8146456?_encoding=UTF8&amp;pd_rd_i=B01L0F6K5C&amp;pd_rd_r=34b75632-85a1-11e9-9b09-4f16de09a724&amp;pd_rd_w=rGCZ0&amp;pd_rd_wg=hu7To&amp;pf_rd_p=33304d62-e1a9-4538-a43c-b1d2dc49800d&amp;pf_rd_r=1A8SNTZPHAMESVH6QJ0N&amp;psc=1&amp;refRID=1A8SNTZPHAMESVH6QJ0N" class="uri">https://www.amazon.com/Antigravity-Batteries-Battery-Starter-Charger/dp/B01L0F6K5C/ref=pd_aw_vtph_263_lp_tr_2/130-0236497-8146456?_encoding=UTF8&amp;pd_rd_i=B01L0F6K5C&amp;pd_rd_r=34b75632-85a1-11e9-9b09-4f16de09a724&amp;pd_rd_w=rGCZ0&amp;pd_rd_wg=hu7To&amp;pf_rd_p=33304d62-e1a9-4538-a43c-b1d2dc49800d&amp;pf_rd_r=1A8SNTZPHAMESVH6QJ0N&amp;psc=1&amp;refRID=1A8SNTZPHAMESVH6QJ0N</a></li>
<li><a href="https://www.adafruit.com/product/1601" class="uri">https://www.adafruit.com/product/1601</a></li>
<li><a href="https://us.seeedstudio.com/5-inch-800x480-Capacitive-TouchScreen-p-2923.html?utm_source=Bazaar+%EF%BC%88%E7%94%B5%E5%95%86%EF%BC%89&amp;utm_campaign=9162fdf13c-September+campaign+%E2%80%94%E2%80%94+1%24_9.21_Japanese_COPY_01&amp;utm_medium=email&amp;utm_term=0_4b071a49e3-9162fdf13c-49714817&amp;ct=t()&amp;mc_cid=9162fdf13c&amp;mc_eid=3012c69022" class="uri">https://us.seeedstudio.com/5-inch-800x480-Capacitive-TouchScreen-p-2923.html?utm_source=Bazaar+%EF%BC%88%E7%94%B5%E5%95%86%EF%BC%89&amp;utm_campaign=9162fdf13c-September+campaign+%E2%80%94%E2%80%94+1%24_9.21_Japanese_COPY_01&amp;utm_medium=email&amp;utm_term=0_4b071a49e3-9162fdf13c-49714817&amp;ct=t()&amp;mc_cid=9162fdf13c&amp;mc_eid=3012c69022</a></li>
</ul>
</section>
<section id="notes-1" class="level4">
<h4 class="anchored" data-anchor-id="notes-1">Notes:</h4>
<ul>
<li><a href="https://hackaday.com/2014/09/18/a-diy-midi-wind-controller/" class="uri">https://hackaday.com/2014/09/18/a-diy-midi-wind-controller/</a></li>
<li><a href="https://gonzos.net/projects/ewi-pi/" class="uri">https://gonzos.net/projects/ewi-pi/</a></li>
<li><a href="http://zynthian.org/" class="uri">http://zynthian.org/</a></li>
<li><a href="https://ewiusb.com/software" class="uri">https://ewiusb.com/software</a></li>
</ul>
<hr>
</section>
</section>
<section id="motocomms" class="level2">
<h2 class="anchored" data-anchor-id="motocomms">Motocomms</h2>
<section id="description-2" class="level4">
<h4 class="anchored" data-anchor-id="description-2">Description:</h4>
<p>A simple and mostly off-the-shelf communication and audio system for helmets</p>
</section>
<section id="user-story-2" class="level4">
<h4 class="anchored" data-anchor-id="user-story-2">User Story:</h4>
<p>Helmet comm units are stupid expensive and sound terrible. And are additive to road noise. And clumsy to control and link. And vendor specific. And another thing to keep charged. And dumb in concept: who’s wants a 5 hr running conversation when we just need to communicate when stopped at an intersection about which way to turn?</p>
<p>I want a way to use my noise-reducing earbuds with an off the shelf radio through my phone so that I can also hear music or GPS.</p>
<p>Also, I like to keep my phone in my jacket pocket so there are no dangling wires. But I don’t want to have to look at the radio to use it or worry about charging it before riding.</p>
</section>
<section id="feature-set-2" class="level4">
<h4 class="anchored" data-anchor-id="feature-set-2">Feature Set:</h4>
<ol type="1">
<li>Custom radio integration
<ol type="1">
<li>GMRS appears to offer best license-free cost-vs-performance, with usable range of a couple miles and cross-compatibility with FRS</li>
</ol></li>
<li><a href="http://projects.somerlot.net/._RoboticsProjects016.html#___sec15">Custom-built HAM radio?</a>
<ol type="1">
<li>Mesh wifi?</li>
</ol></li>
<li>App-based mixer for phone for multi-audio stream management (GPS, music, and comms at once!)</li>
<li>Custom handlebar control to only activate mic during push-to-talk, or switch it to VOX for regular hands-free, or turn off music</li>
<li>Charging bracket</li>
<li>Cross-use capable for skiing, hiking, trekking, and emergencies that are out of cell range</li>
<li>Components that are cheap enough to keep spares of or available enough to find anywhere</li>
</ol>
</section>
<section id="phasing-2" class="level4">
<h4 class="anchored" data-anchor-id="phasing-2">Phasing:</h4>
<ol type="1">
<li>Start with wired connectivity, with phone and radio in tank bag (done):</li>
<li><a href="https://www.youtube.com/watch?v=4U5ArX7J7ps">Noise-cancelling earbuds</a> but mounting the microphone is the tricky bit</li>
<li>Build <a href="https://www.monoprice.com/product?p_id=10146">stereo-line mixer</a> to combine radio, phone, and earbuds</li>
<li>Add <a href="https://baofengtech.com/product/adapter-3-5mm/">handlebar switch</a> to mic for PTT</li>
<li>Add wireless integration
<ol type="1">
<li>Build radio mount with charge bracket</li>
<li>Build custom Bluetooth audio adapter to connect radio to phone</li>
</ol></li>
</ol>
</section>
<section id="bom-2" class="level4">
<h4 class="anchored" data-anchor-id="bom-2">BOM:</h4>
<ul>
<li>TBD depending on radio</li>
</ul>
</section>
<section id="commercial-offerings" class="level4">
<h4 class="anchored" data-anchor-id="commercial-offerings">Commercial offerings:</h4>
<ul>
<li><a href="https://forums.radioreference.com/threads/would-a-gmrs-frs-radio-built-into-a-smartphone-or-battery-case-interest-you.394416/" class="uri">https://forums.radioreference.com/threads/would-a-gmrs-frs-radio-built-into-a-smartphone-or-battery-case-interest-you.394416/</a></li>
<li><a href="https://gotenna.com/" class="uri">https://gotenna.com/</a></li>
<li><a href="https://beartooth.com" class="uri">https://beartooth.com</a></li>
</ul>
<hr>
</section>
</section>
<section id="track-gdd" class="level2">
<h2 class="anchored" data-anchor-id="track-gdd">Track GDD</h2>
<ol type="1">
<li>Use a (google?) calendar of observations to track growing degree days
<ol type="1">
<li>User enters garden events on the google calendar when it happens (ie sunflowers bloom)</li>
<li>Next season the garden events are predicted</li>
<li>can start off with a database of “known” GDD events (crops, etc)</li>
<li>can track other seasonal things like honeybee activity, pest occurance, etc</li>
<li>The program uses an online API to pull daily min/max temperatures for user’s locale and calculate GDD for each observed event from previous seasons</li>
<li>can use long-term temp forecasts to predict occurances of events</li>
<li>Updates calendar of predicted events</li>
</ol></li>
<li>Host on <a href="https://www.pythonanywhere.com/user/csomerlot/shares/d795cc4ade44422ea92ab1f1d43fab8e/">pythonanywhere</a> as a web service</li>
<li>References</li>
<li><a href="https://en.wikipedia.org/wiki/Growing_degree-day">Calculating GDD</a></li>
<li>Local temperature
<ol type="1">
<li>Onset datalogger</li>
</ol></li>
<li><a href="https://rapidapi.com/darkskyapis/api/dark-sky/endpoints">DarkSky API</a></li>
</ol>
<hr>
</section>
<section id="tartan-designer" class="level2">
<h2 class="anchored" data-anchor-id="tartan-designer">Tartan designer</h2>
<ol type="1">
<li>A gui-based designer for weaving</li>
<li>A great use-case and teaching example of using graphics and Programming</li>
<li><a href="https://docs.python.org/3.3/library/turtle.html" class="uri">https://docs.python.org/3.3/library/turtle.html</a></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./code/TartanDesigner.py.png" class="img-fluid figure-img"></p>
<figcaption>Sample output.</figcaption>
</figure>
</div>
<p><a href="./code/TartanDesigner.py">Link to the code</a></p>
<hr>
</section>
<section id="somerlot-shooting-support-system-s4" class="level2">
<h2 class="anchored" data-anchor-id="somerlot-shooting-support-system-s4">Somerlot Shooting Support System (S4)</h2>
<section id="description-3" class="level4">
<h4 class="anchored" data-anchor-id="description-3">Description:</h4>
<p>Combination of hardware and software for calculations, capturing data, and visualizing shot placement</p>
</section>
<section id="user-story-3" class="level4">
<h4 class="anchored" data-anchor-id="user-story-3">User Story:</h4>
<p>Long range precision shooting requires accouting for many variables, as well as testing. Recording all this is cumbersome. Viewing the shot with a spotting scope is difficult. Waiting to go down-range and observe results makes for a lot of wasted time. Unknown weather, distance, and load variables wastes a lot of ammo. Can a bespoke computing platform simplify it all and make it more enjoyable, efficient, and cheap?</p>
</section>
<section id="references" class="level4">
<h4 class="anchored" data-anchor-id="references">References:</h4>
<ol type="1">
<li><a href="https://www.hornady.com/4dofapp">Hornady Shooting App</a></li>
</ol>
</section>
<section id="feature-set-3" class="level4">
<h4 class="anchored" data-anchor-id="feature-set-3">Feature Set:</h4>
<ol type="1">
<li>Computes and then measures ballistics</li>
<li>Variables for load, wind, pressure, distance (via GPS with point averaging)</li>
<li><a href="https://pypi.org/project/ballistics/">Trajectory Science lib</a></li>
<li>stores data in a database</li>
<li>Long-range wifi for networking back to phone</li>
<li>Camera on target with webcam to phone, records placement in database</li>
<li>Integrates with a chronograph <a href="https://shop.opticsplanet.com/competition-electronics-prochrono-dlx-with-bluetooth.html?_iv_code=2PI-CRO-CEPCDLX-CEI-3820&amp;gclsrc=aw.ds&amp;gclid=Cj0KCQiAj4ecBhD3ARIsAM4Q_jHLQj0npmX-11q3qBX8V61-LgSasbzHsAETmwMLLr9fmUjKxUiL5wQaAtIiEALw_wcB">like this one</a></li>
</ol>
</section>
<section id="phasing-3" class="level4">
<h4 class="anchored" data-anchor-id="phasing-3">Phasing:</h4>
<ul>
<li>Get a ballistics algorithm figured out</li>
<li>Create web-based UI</li>
<li>Build out hardware</li>
</ul>
</section>
<section id="bom-3" class="level4">
<h4 class="anchored" data-anchor-id="bom-3">BOM:</h4>
<ol type="1">
<li>RPi</li>
<li>Camera sensor with lens</li>
</ol>
<hr>
</section>
</section>
<section id="retail-support-tools" class="level2">
<h2 class="anchored" data-anchor-id="retail-support-tools">Retail support tools</h2>
<section id="scheduler" class="level3">
<h3 class="anchored" data-anchor-id="scheduler">Scheduler</h3>
<p>Basic example of a rule-based genetic algorithm optimizer for finding optimal group schedules</p>
<p><a href="./code/Scheduler.py">Link to the code</a></p>
</section>
<section id="rewards-program-calculator" class="level3">
<h3 class="anchored" data-anchor-id="rewards-program-calculator">Rewards Program Calculator</h3>
<ol type="1">
<li>Description
<ol type="1">
<li>This application was developed to track customer spending, in order to determine eligibility for rewards certificates. It relies on data exported from the POS system, and does not in any way touch any databases.</li>
</ol></li>
<li>Usage
<ol type="1">
<li>Overview
<ol type="1">
<li>Assuming that you created the spreadsheet correctly, usage is pretty self explanatory. There are only 3 buttons. However, if the application crashes, it should prompt you to automatically send an error report via email to the developer (Chris).</li>
</ol></li>
<li>Input
<ol type="1">
<li>This application reads in an excel spreadsheet that was exported from the EaglePOS system, which must include sales YTD for each customer, as well as mailing info. If the application can’t find the necessary data, it should let you know.</li>
</ol></li>
<li>Output
<ol type="1">
<li>This is the secret part, and will be filled in later.</li>
</ol></li>
</ol></li>
</ol>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>