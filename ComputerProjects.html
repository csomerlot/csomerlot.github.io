<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Computer Projects">

<title>Computer Projects</title>


<style type="text/css">
/* blueish style */

/* Color definitions:  http://www.december.com/html/spec/color0.html
   CSS examples:       http://www.w3schools.com/css/css_examples.asp */

body {
  margin-top: 1.0em;
  background-color: #ffffff;
  font-family: Helvetica, Arial, FreeSans, san-serif;
  color: #000000;
}
h1 { font-size: 1.8em; color: #1e36ce; }
h2 { font-size: 1.6em; color: #1e36ce; }
h3 { font-size: 1.4em; color: #1e36ce; }
a { color: #1e36ce; text-decoration:none; }
tt { font-family: "Courier New", Courier; }
/* pre style removed because it will interfer with pygments */
p { text-indent: 0px; }
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-style: normal; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Robotics Club Setup', 1, None, '___sec0'),
              ('Home Internet Gateway', 1, None, '___sec1'),
              ('Arduino Wind Instrument', 1, None, '___sec2'),
              ('Motocomms', 1, None, '___sec3'),
              ('Track GDD', 1, None, '___sec4'),
              ('Tartan designer', 1, None, '___sec5'),
              ('Somerlot Shooting Support System (S4)', 1, None, '___sec6'),
              ('Retail support tools', 1, None, '___sec7'),
              ('Scheduler', 2, None, '___sec8'),
              ('Rewards Program Calculator', 2, None, '___sec9'),
              ('Homemade Variable Frequency Drive', 1, None, '___sec10'),
              ('Common Mobile Compute Platform', 1, None, '___sec11'),
              ('Domotics', 1, None, '___sec12'),
              ('Automotive Media System', 1, None, '___sec13'),
              ('GPS Chartplotter', 1, None, '___sec14'),
              ('Common Sensor and Datalogger Platform', 1, None, '___sec15'),
              ('Micro Hydroponics', 1, None, '___sec16'),
              ('Technology as Art', 1, None, '___sec17'),
              ('Wood Burning Plotter', 2, None, '___sec18'),
              ('Lightning Catcher', 2, None, '___sec19'),
              ('Irrigation Remote', 1, None, '___sec20'),
              ('The Best Damn Radio System', 1, None, '___sec21'),
              ('Fixed Wing UAV', 1, None, '___sec22'),
              ('Submersible / Surface ROV', 1, None, '___sec23'),
              ('Pool Octobot', 1, None, '___sec24'),
              ('Scarecrow Targeting System', 1, None, '___sec25'),
              ('Invasive Species Patroller', 1, None, '___sec26'),
              ('Signal-Tracking Antenna Mount', 1, None, '___sec27')]}
end of tocinfo -->

<body>

    
<!-- ------------------- main content ---------------------- -->



<center><h1>Computer Projects</h1></center>  <!-- document title -->

<h1 id="table_of_contents">Table of contents</h2>

<p>
<a href="#___sec0"> Robotics Club Setup </a><br>
<a href="#___sec1"> Home Internet Gateway </a><br>
<a href="#___sec2"> Arduino Wind Instrument </a><br>
<a href="#___sec3"> Motocomms </a><br>
<a href="#___sec4"> Track GDD </a><br>
<a href="#___sec5"> Tartan designer </a><br>
<a href="#___sec6"> Somerlot Shooting Support System (S4) </a><br>
<a href="#___sec7"> Retail support tools </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec8"> Scheduler </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec9"> Rewards Program Calculator </a><br>
<a href="#___sec10"> Homemade Variable Frequency Drive </a><br>
<a href="#___sec11"> Common Mobile Compute Platform </a><br>
<a href="#___sec12"> Domotics </a><br>
<a href="#___sec13"> Automotive Media System </a><br>
<a href="#___sec14"> GPS Chartplotter </a><br>
<a href="#___sec15"> Common Sensor and Datalogger Platform </a><br>
<a href="#___sec16"> Micro Hydroponics </a><br>
<a href="#___sec17"> Technology as Art </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec18"> Wood Burning Plotter </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec19"> Lightning Catcher </a><br>
<a href="#___sec20"> Irrigation Remote </a><br>
<a href="#___sec21"> The Best Damn Radio System </a><br>
<a href="#___sec22"> Fixed Wing UAV </a><br>
<a href="#___sec23"> Submersible / Surface ROV </a><br>
<a href="#___sec24"> Pool Octobot </a><br>
<a href="#___sec25"> Scarecrow Targeting System </a><br>
<a href="#___sec26"> Invasive Species Patroller </a><br>
<a href="#___sec27"> Signal-Tracking Antenna Mount </a><br>
</p>
<p>
<!-- !split -->

<h1 id="___sec0">Robotics Club Setup </h1>
<b>Maker kits:</b>

<ol>
<li> Tools

<ol type="a"></li>
   <li> Build tray/mat (with edges, for roll-y parts)</li>
   <li> ESC bracelet</li>
</ol>

<li> Parts warehousing

<ol type="a"></li>
   <li> Tackle box with baggie system</li>
</ol>

<li> Documentation

<ol type="a"></li>
   <li> GoPro for video logging</li>
   <li> Rocket book</li>
   <li> DocOnce</li>
   <li> private git server</li>
</ol>

<li> Dev Environment

<ol type="a"></li>
   <li> Platforms</li>

<ol>
       <li> IaaS: AWS Workspace</li>
       <li> PaaS: Platform.io</li>
       <li> Local: Raspberry Pi</li>
</ol>

   <li> Software:</li>

<ol>
       <li> Fritzing</li>
       <li> 3D CAD

<ol type="a"></li>
           <li> SolidPython (OpenSCAD) (because programming is better)</li>
           <li> DesignSpark Mechanical</li>

<ol>
             <li> Opens .skp!</li>
             <li> But no linux</li>
</ol>

</ol>

       <li> Blockly</li>
       <li> Anaconda Python Env</li>
       <li> Atom</li>
</ol>

</ol>

</ol>

<b>Projects:</b>

<ol>
<li> Init: Individual project options

<ol type="a"></li>
   <li> Basic battle bots</li>
   <li> Steampunk wearables</li>
   <li> Ornaments</li>
</ol>

<li> Main Missions: Group effort determined by vote

<ol type="a"></li>
   <li> Citizen science</li>
   <li> Tech-art integration</li>
</ol>

</ol>

<b>Requirements:</b>

<ul>
<li> Grades</li>
<li> Portfolio</li>
<li> Teacher recommendation</li>
<li> Behavior</li>
</ul>

<b>Coding DevEnv:</b>

<ul>
<li> Visual programming (blockly-scratch-mindstorm)</li>
<li> Individual programming jobs with unit testing</li>
<li> Agile - Kanban - scrum</li>
<li> Arduino Studio must be installed locally, no good browser-based IDE (need to test PlatformIO though)</li>
</ul>

<!-- !split -->

<h1 id="___sec1">Home Internet Gateway </h1>
<b>Description:</b>
Cable modem, IoT gateway, wifi router/repeater, and firewall device.

<p>
<b>User Story:</b>
I just want the internet to work. I also want to protect my family and house, integrate with Domotics and IoT, and give the internet company their crap hardware back. Maybe I can even eventually dump the internet company completely for community-based wifi or a free-space optical link.

<p>
<b>Feature Set:</b>

<ol>
<li> Parental Filtering and logging</li>
<li> Directional Wifi</li>
<li> Switching between internet sources</li>
<li> Performance and health dashboard</li>
<li> wikipedia and media cache</li>
<li> privacy and ad blocking</li>
<li> <a href="https://othernet.is/" target="_self">Othernet</a> Integration (I <em>so</em> hope this project works)</li>
<li> <a href="https://github.com/IRNAS/FSO-systems" target="_self">FSO link</a></li>
</ol>

<b>Phasing:</b>

<ul>
<li> configure basic access point (check functionality after each step)</li>

<ul>
  <li> Basic config shown <a href="https://www.raspberrypi.org/documentation/configuration/wireless/access-point-routed.md" target="_self">here</a> (first part only) including security (but not ufw firewall) set up shown <a href="https://www.raspberrypi.org/documentation/configuration/security.md" target="_self">here</a></li>

<ul>
    <li> Use wlan1 instead of on-board wlan0</li>
    <li> Enable <a href="https://lb.raspberrypi.org/forums/viewtopic.php?t=92859" target="_self">hostapd</a> and <a href="https://www.linux.com/tutorials/advanced-dnsmasq-tips-and-tricks/" target="_self">dnsmasq</a> logging</li>
    <li> Open network via hostapd conf shown <a href="https://elinux.org/RPI-Wireless-Hotspot" target="_self">here</a></li>
</ul>

  <li> <a href="https://serverfault.com/questions/214996/iptables-allow-ssh-access-only-nothing-else-in-or-out" target="_self">mod iptables to allow ssh in only</a></li>

<ul>
    <li> check with nmap -sS -p 1-65535 <external ip></li>
    <li> set up sshd with <a href="https://www.cyberciti.biz/tips/linux-unix-bsd-openssh-server-best-practices.html" target="_self">best practices</a></li>
</ul>

  <li> create a log of sites visited by MAC address</li>

<ul>
    <li> set up tcpdump to save link headers to <a href="https://www.raspberrypi.org/forums/viewtopic.php?t=237584" target="_self">MySQL</a> (see code below)</li>
    <li> The better option is to use a <a href="https://www.dinofizzotti.com/blog/2019-01-09-running-a-man-in-the-middle-proxy-on-a-raspberry-pi-3/" target="_self">MITM proxy</a> in transparent mode, but that requires users accepting and installing a certificate</li>
    <li> use <a href="https://dash-gallery.plotly.host/dash-oil-and-gas/" target="_self">dash</a> to create BI reports of traffic</li>
    <li> link with <a href="https://code.wireshark.org/review/gitweb?p=wireshark.git;a=blob_plain;f=manuf" target="_self">MAC dbs</a> and commonly-used domains DB</li>
</ul>

  <li> set up <a href="https://aws.amazon.com/blogs/startups/how-to-build-a-serverless-dynamic-dns-system-with-aws/" target="_self">Dynamic DNS</a> (see code below)</li>
  <li> set up a DNS Sinkhole such as <a href="https://en.wikipedia.org/wiki/Pi-hole" target="_self">pi-hole</a> or <a href="https://github.com/quidsup/notrack" target="_self">NoTrack</a> to cut down on ads</li>
  <li> use OpenDNS to cut down on phishing and increase DNS lookup speeds (<a href="https://www.raspberrypi.org/forums/viewtopic.php?t=210933" target="_self">Has to be set up in dnsmasq using option 6</a>)</li>
  <li> set up <a href="https://learn.adafruit.com/onion-pi?view=all" target="_self">tor</a> or a VPN</li>
  <li> set up config landing page</li>

<ul>
    <li> Switch choice of wlan0 or eth0</li>
    <li> Tune filters, dyndns, dns sink</li>
    <li> Show dash traffic metrics</li>
    <li> Show status metrics (by user)</li>
</ul>

</ul>

<li> swap cable modem</li>
<li> add external storage with media library</li>
<li> install othernet</li>
<li> build FSO tranceivers</li>

<ul>
  <li> <a href="https://www.adafruit.com/product/1056" target="_self">Laser</a> transmitter coupled to a <a href="https://www.adafruit.com/product/2831" target="_self">photo transister</a> receiver mounted on a <a href="https://www.amazon.com/BARSKA-15-40x50-Colorado-Spotting-Scope/dp/B0049IZMUW/ref=sr_1_16?dchild=1&keywords=spotting+scope&qid=1578058031&sr=8-16" target="_self">spotting scope</a>, with fiber optic modulators</li>
</ul>

</ul>

<b>BOM:</b>

<ol>
<li> <a href="/._ComputerProjects010.html#___sec10" target="_self">Common Mobile Compute Platform</a> (two, one for testing, one for production)</li>
</ol>

<b>Notes:</b>

<ul>
<li> <a href="https://www.digikey.com/en/articles/techzone/2013/oct/building-free-space-optical-systems" target="_self"><tt>https://www.digikey.com/en/articles/techzone/2013/oct/building-free-space-optical-systems</tt></a></li>
<li> <a href="http://shop.oreilly.com/product/9780596002046.do" target="_self"><tt>http://shop.oreilly.com/product/9780596002046.do</tt></a></li>
</ul>

<b>GRAPHICS:</b>

<p>
<center> <!-- figure label: --> <div id="fig:los"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 1:  Line of sight between office and home.  <!-- caption label: fig:los --> </p></center>
<p><img src="./Programming/AP_Viewshed.jpg" align="bottom" width=600></p>
</center>

<p>
<b>CODE:</b>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #3D7B7B; font-style: italic">### This script updates Route53 AWS Cloud service with the DNS record for the public IP</span>


<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">boto3</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">socket</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">netifaces</span>

public_ip <span style="color: #666666">=</span> ni<span style="color: #666666">.</span>ifaddresses(<span style="color: #BA2121">&#39;eth0&#39;</span>)[AF_INET][<span style="color: #666666">0</span>][<span style="color: #BA2121">&#39;addr&#39;</span>]
<span style="color: #008000">print</span>(public_ip)

<span style="color: #3D7B7B; font-style: italic">#https://github.com/awslabs/route53-dynamic-dns-with-lambda/blob/master/v1/dynamic_dns_lambda.py</span>
client <span style="color: #666666">=</span> boto3<span style="color: #666666">.</span>client(<span style="color: #BA2121">&#39;route53&#39;</span> )
route_53_zone_id     <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&#39;</span> <span style="color: #3D7B7B; font-style: italic"># your zone ID here</span>
route_53_record_name <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&#39;</span> <span style="color: #3D7B7B; font-style: italic"># your FQDN here</span>
route_53_record_type <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;A&#39;</span>
route_53_record_ttl  <span style="color: #666666">=</span> <span style="color: #666666">300</span>

response <span style="color: #666666">=</span> client<span style="color: #666666">.</span>change_resource_record_sets(
            HostedZoneId<span style="color: #666666">=</span>route_53_zone_id,
            ChangeBatch<span style="color: #666666">=</span>{
                <span style="color: #BA2121">&#39;Changes&#39;</span>: [
                    {
                        <span style="color: #BA2121">&#39;Action&#39;</span>: <span style="color: #BA2121">&#39;UPSERT&#39;</span>,
                        <span style="color: #BA2121">&#39;ResourceRecordSet&#39;</span>: {
                            <span style="color: #BA2121">&#39;Name&#39;</span>: route_53_record_name,
                            <span style="color: #BA2121">&#39;Type&#39;</span>: route_53_record_type,
                            <span style="color: #BA2121">&#39;TTL&#39;</span>: route_53_record_ttl,
                            <span style="color: #BA2121">&#39;ResourceRecords&#39;</span>: [
                                {
                                    <span style="color: #BA2121">&#39;Value&#39;</span>: public_ip
                                }
                            ]
                        }
                    }
                ]
            }
        )
<span style="color: #008000">print</span>(response)
</pre></div>
<p>
<b>CODE:</b>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">socket</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">sys</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">os</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">time</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">subprocess</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sub</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">log</span>(message):
    <span style="color: #008000">print</span>(message)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">csvInit</span>():
    <span style="color: #008000; font-weight: bold">with</span> <span style="color: #008000">open</span>(<span style="color: #19177C">__file__</span><span style="color: #666666">.</span>replace(<span style="color: #BA2121">&quot;.py&quot;</span>, <span style="color: #BA2121">&quot;.csv&quot;</span>), <span style="color: #BA2121">&#39;w&#39;</span>, encoding<span style="color: #666666">=</span><span style="color: #BA2121">&#39;utf-8&#39;</span>, newline<span style="color: #666666">=</span><span style="color: #BA2121">&#39;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>) <span style="color: #008000; font-weight: bold">as</span> csvf:
        csvf<span style="color: #666666">.</span>write(<span style="color: #BA2121">&quot;datetime,path,size</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span>)

    <span style="color: #008000; font-weight: bold">return</span> csvf<span style="color: #666666">.</span>name

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">csvInsert</span>(fname, data):
    <span style="color: #008000; font-weight: bold">with</span> <span style="color: #008000">open</span>(fname, <span style="color: #BA2121">&#39;a&#39;</span>, encoding<span style="color: #666666">=</span><span style="color: #BA2121">&#39;utf-8&#39;</span>, newline<span style="color: #666666">=</span><span style="color: #BA2121">&#39;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>) <span style="color: #008000; font-weight: bold">as</span> csvf:
        <span style="color: #008000; font-weight: bold">for</span> row <span style="color: #AA22FF; font-weight: bold">in</span> data:
            csvf<span style="color: #666666">.</span>write(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">,</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">,</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>format(time<span style="color: #666666">.</span>strftime(<span style="color: #BA2121">&quot;%m/</span><span style="color: #A45A77; font-weight: bold">%d</span><span style="color: #BA2121">/%Y %H:%M&quot;</span>, time<span style="color: #666666">.</span>localtime()), row, data[row]))

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">dbInit</span>():
    <span style="color: #3D7B7B; font-style: italic">## https://enterprise-docs.anaconda.com/en/latest/data-science-workflows/data/mariadb.html</span>
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">mysql.connector</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">mariadb</span>
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">json</span>

    <span style="color: #3D7B7B; font-style: italic">## take care to configure security correctly:</span>
    <span style="color: #3D7B7B; font-style: italic">#### https://stackoverflow.com/questions/1559955/host-xxx-xx-xxx-xxx-is-not-allowed-to-connect-to-this-mysql-server</span>
    <span style="color: #3D7B7B; font-style: italic">#### https://mariadb.com/kb/en/configuring-mariadb-for-remote-client-access/</span>
    <span style="color: #3D7B7B; font-style: italic">## Now, read the credentials from secret</span>
    credentials <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
    <span style="color: #008000; font-weight: bold">with</span> <span style="color: #008000">open</span>(<span style="color: #19177C">__file__</span><span style="color: #666666">.</span>replace(<span style="color: #BA2121">&quot;.py&quot;</span>, <span style="color: #BA2121">&quot;.jsn&quot;</span>)) <span style="color: #008000; font-weight: bold">as</span> f:
        credentials <span style="color: #666666">=</span> json<span style="color: #666666">.</span>load(f)

    <span style="color: #3D7B7B; font-style: italic"># Ensure your credentials were setup</span>
    <span style="color: #008000; font-weight: bold">if</span> credentials:
        <span style="color: #3D7B7B; font-style: italic"># Connect to the DB</span>
        connection <span style="color: #666666">=</span> mariadb<span style="color: #666666">.</span>connect(
            user<span style="color: #666666">=</span>credentials<span style="color: #666666">.</span>get(<span style="color: #BA2121">&#39;user&#39;</span>),
            password<span style="color: #666666">=</span>credentials<span style="color: #666666">.</span>get(<span style="color: #BA2121">&#39;password&#39;</span>),
            database<span style="color: #666666">=</span>credentials<span style="color: #666666">.</span>get(<span style="color: #BA2121">&#39;database&#39;</span>),
            host<span style="color: #666666">=</span>credentials<span style="color: #666666">.</span>get(<span style="color: #BA2121">&#39;host&#39;</span>)
        )
        cursor <span style="color: #666666">=</span> connection<span style="color: #666666">.</span>cursor()

        <span style="color: #3D7B7B; font-style: italic"># Execute the query</span>
        cursor<span style="color: #666666">.</span>execute(<span style="color: #BA2121">&quot;CREATE TABLE IF NOT EXISTS activity (</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #BA2121">            date DATE,  hour TINYINT, minute TINYINT, second TINYINT, </span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #BA2121">            len INT UNSIGNED NOT NULL, </span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #BA2121">            fromAddress NVARCHAR(255) NOT NULL, fromPort NVARCHAR (50), fromContext NVARCHAR (50),</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #BA2121">            toAddress NVARCHAR(255) NOT NULL, toPort NVARCHAR (50), toContext NVARCHAR (50)</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #BA2121">            );&quot;</span>)

        <span style="color: #008000; font-weight: bold">return</span> connection

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">dbInsert</span>(dbconn, data):
    cursor <span style="color: #666666">=</span> dbconn<span style="color: #666666">.</span>cursor()
    insertStr <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;INSERT INTO activity VALUES &quot;</span>
    now <span style="color: #666666">=</span> time<span style="color: #666666">.</span>localtime()

    <span style="color: #008000; font-weight: bold">for</span> path <span style="color: #AA22FF; font-weight: bold">in</span> data:
        insertStr <span style="color: #666666">+=</span> <span style="color: #BA2121">&quot;(&#39;</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">&#39;,</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">,</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">,</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">,</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>format(time<span style="color: #666666">.</span>strftime(<span style="color: #BA2121">&quot;%Y-%m-</span><span style="color: #A45A77; font-weight: bold">%d</span><span style="color: #BA2121">&quot;</span>, now), now[<span style="color: #666666">3</span>], now[<span style="color: #666666">4</span>], now[<span style="color: #666666">5</span>], data[path])
        <span style="color: #008000; font-weight: bold">for</span> pp <span style="color: #AA22FF; font-weight: bold">in</span> parsePath(path):
            insertStr <span style="color: #666666">+=</span> <span style="color: #BA2121">&quot;,&#39;</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">&#39;&quot;</span><span style="color: #666666">.</span>format(pp)
        insertStr <span style="color: #666666">+=</span> <span style="color: #BA2121">&quot;), &quot;</span>
    insertStr <span style="color: #666666">=</span> insertStr[:<span style="color: #666666">-2</span>] <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;;&#39;</span>

    cursor<span style="color: #666666">.</span>execute(insertStr)
    dbconn<span style="color: #666666">.</span>commit()

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">parsePath</span>(path):
    _from, _to <span style="color: #666666">=</span> path<span style="color: #666666">.</span>strip()<span style="color: #666666">.</span>split(<span style="color: #BA2121">&quot; &gt; &quot;</span>)
    _fromPort <span style="color: #666666">=</span> _from<span style="color: #666666">.</span>split(<span style="color: #BA2121">&quot;.&quot;</span>)[<span style="color: #666666">-1</span>]
    _fromAdd <span style="color: #666666">=</span> _from[:<span style="color: #666666">-1*</span>(<span style="color: #008000">len</span>(_fromPort)<span style="color: #666666">+1</span>)]
    _fromContext <span style="color: #666666">=</span> domainLookup(_fromAdd)
    _toPort <span style="color: #666666">=</span> _to<span style="color: #666666">.</span>split(<span style="color: #BA2121">&quot;.&quot;</span>)[<span style="color: #666666">-1</span>]
    _toAdd <span style="color: #666666">=</span> _to[:<span style="color: #666666">-1*</span>(<span style="color: #008000">len</span>(_toPort)<span style="color: #666666">+1</span>)]
    _toContext <span style="color: #666666">=</span> domainLookup(_toAdd)

    <span style="color: #008000; font-weight: bold">return</span> _fromAdd, _fromPort, _fromContext, _toAdd, _toPort, _toContext

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">domainLookup</span>(address):
    <span style="color: #008000; font-weight: bold">if</span> address <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;BCBRWN-PF0QMJMY&#39;</span> <span style="color: #AA22FF; font-weight: bold">or</span> address<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&quot;.&quot;</span>,<span style="color: #BA2121">&quot;&quot;</span>)<span style="color: #666666">.</span>isdigit(): context <span style="color: #666666">=</span> address
    <span style="color: #008000; font-weight: bold">elif</span> address<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">&#39;1e100.net&#39;</span>): context <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;gmail&quot;</span>
    <span style="color: #008000; font-weight: bold">elif</span> address<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">&quot;iRobot&quot;</span>): context <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Roomba&quot;</span>
    <span style="color: #008000; font-weight: bold">elif</span> address<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">&quot;instagram&quot;</span>): context <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;instagram&quot;</span>
    <span style="color: #008000; font-weight: bold">elif</span> address<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">&quot;.com&quot;</span>) <span style="color: #AA22FF; font-weight: bold">or</span> address<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">&quot;.net&quot;</span>) <span style="color: #AA22FF; font-weight: bold">or</span> address<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">&quot;.org&quot;</span>):
        context <span style="color: #666666">=</span> address<span style="color: #666666">.</span>split(<span style="color: #BA2121">&quot;.&quot;</span>)[<span style="color: #666666">-2</span>]
    <span style="color: #008000; font-weight: bold">else</span>: context <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">return</span> context

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">__name__</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    <span style="color: #3D7B7B; font-style: italic">## simplest use is &#39;nohup python3 watcher.py &amp;&#39;, but making it a systemctl service is better: https://www.raspberrypi.org/documentation/linux/usage/systemd.md</span>

    <span style="color: #3D7B7B; font-style: italic"># datastore = csvInit()</span>
    <span style="color: #3D7B7B; font-style: italic"># saveData = csvInsert</span>
    <span style="color: #3D7B7B; font-style: italic"># or</span>
    datastore <span style="color: #666666">=</span> dbInit()
    saveData <span style="color: #666666">=</span> dbInsert

    timeIndex <span style="color: #666666">=</span> <span style="color: #666666">4</span> <span style="color: #3D7B7B; font-style: italic">## index of the struct_time; 5 for sum by second, 4 for sum data by minute, 3 for sum by hour</span>

    lastmin <span style="color: #666666">=</span> time<span style="color: #666666">.</span>localtime()[timeIndex]
    db <span style="color: #666666">=</span> {}

    <span style="color: #3D7B7B; font-style: italic">## run tcpdump in buffer mode, link headers only</span>
    p <span style="color: #666666">=</span> sub<span style="color: #666666">.</span>Popen((<span style="color: #BA2121">&#39;sudo&#39;</span>, <span style="color: #BA2121">&#39;tcpdump&#39;</span>, <span style="color: #BA2121">&#39;-q&#39;</span>, <span style="color: #BA2121">&#39;-i&#39;</span>, <span style="color: #BA2121">&#39;wlan1&#39;</span>, <span style="color: #BA2121">&#39;-le&#39;</span>, <span style="color: #BA2121">&#39;greater 55 and tcp&#39;</span>), stdout<span style="color: #666666">=</span>sub<span style="color: #666666">.</span>PIPE)
    <span style="color: #008000; font-weight: bold">for</span> row <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">iter</span>(p<span style="color: #666666">.</span>stdout<span style="color: #666666">.</span>readline, <span style="color: #BA2121">b&#39;&#39;</span>):

    <span style="color: #3D7B7B; font-style: italic">## or use a test file for debugging</span>
    <span style="color: #3D7B7B; font-style: italic"># with open(&#39;test.log&#39;, &#39;rb&#39;) as f: testlog = f.readlines()</span>
    <span style="color: #3D7B7B; font-style: italic"># for row in testlog:</span>

        <span style="color: #008000; font-weight: bold">try</span>:
            mainParts <span style="color: #666666">=</span>  row<span style="color: #666666">.</span>decode(<span style="color: #BA2121">&#39;utf-8&#39;</span>)<span style="color: #666666">.</span>strip()<span style="color: #666666">.</span>split(<span style="color: #BA2121">&#39;,&#39;</span>)
            nextParts <span style="color: #666666">=</span> mainParts[<span style="color: #666666">2</span>]<span style="color: #666666">.</span>split(<span style="color: #BA2121">&#39;:&#39;</span>)
            path <span style="color: #666666">=</span> nextParts[<span style="color: #666666">1</span>]
            length <span style="color: #666666">=</span> <span style="color: #008000">int</span>(nextParts[<span style="color: #666666">0</span>][<span style="color: #666666">7</span>:])
            <span style="color: #008000; font-weight: bold">if</span> path <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #AA22FF; font-weight: bold">in</span> db: db[path] <span style="color: #666666">=</span> <span style="color: #666666">0</span>
            db[path]<span style="color: #666666">+=</span> length

            <span style="color: #008000; font-weight: bold">if</span> lastmin <span style="color: #666666">!=</span> time<span style="color: #666666">.</span>localtime()[timeIndex]:
                saveData(datastore, db)
                db <span style="color: #666666">=</span> {}
                lastmin <span style="color: #666666">=</span> time<span style="color: #666666">.</span>localtime()[timeIndex]

        <span style="color: #008000; font-weight: bold">except</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>:
            log(<span style="color: #BA2121">&quot;Bad row: </span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>format(row<span style="color: #666666">.</span>strip()))
</pre></div>
<p>
<!-- !split -->

<h1 id="___sec2">Arduino Wind Instrument </h1>
<b>Description:</b>
an inexpensive and simple electronic wind instrument to learn digital music programming

<p>
<b>User Story:</b>
Real instruments are expensive, and you can only learn to play music...

<p>
<b>Feature Set:</b>

<ol>
<li> Breath and bite sensors</li>
<li> Sax fingering</li>
<li> Wireless midi port</li>
<li> FOSS full synth with effects</li>
</ol>

<b>Phasing:</b>

<ul>
<li> Pick up an Akai EWI</li>
<li> Make a portable sound system</li>
<li> Pick up the Zynthian kit parts</li>
</ul>

<b>BOM:</b>

<ul>
<li> <a href="https://www.hifiberry.com/products/dacplus/" target="_self"><tt>https://www.hifiberry.com/products/dacplus/</tt></a></li>
<li> <a href="https://www.amazon.com/BOSS-Audio-CE200M-Monoblock-Amplifier/dp/B0077IA7FG" target="_self"><tt>https://www.amazon.com/BOSS-Audio-CE200M-Monoblock-Amplifier/dp/B0077IA7FG</tt></a>?th=1&psc=1</li>
<li> <a href="https://www.amazon.com/Antigravity-Batteries-Battery-Starter-Charger/dp/B01L0F6K5C/ref=pd_aw_vtph_263_lp_tr_2/130-0236497-8146456" target="_self"><tt>https://www.amazon.com/Antigravity-Batteries-Battery-Starter-Charger/dp/B01L0F6K5C/ref=pd_aw_vtph_263_lp_tr_2/130-0236497-8146456</tt></a>?_encoding=UTF8&pd_rd_i=B01L0F6K5C&pd_rd_r=34b75632-85a1-11e9-9b09-4f16de09a724&pd_rd_w=rGCZ0&pd_rd_wg=hu7To&pf_rd_p=33304d62-e1a9-4538-a43c-b1d2dc49800d&pf_rd_r=1A8SNTZPHAMESVH6QJ0N&psc=1&refRID=1A8SNTZPHAMESVH6QJ0N</li>
<li> <a href="https://www.adafruit.com/product/1601" target="_self"><tt>https://www.adafruit.com/product/1601</tt></a></li>
<li> <a href="https://us.seeedstudio.com/5-inch-800x480-Capacitive-TouchScreen-p-2923.html" target="_self"><tt>https://us.seeedstudio.com/5-inch-800x480-Capacitive-TouchScreen-p-2923.html</tt></a>?utm_source=Bazaar+%EF%BC%88%E7%94%B5%E5%95%86%EF%BC%89&utm_campaign=9162fdf13c-September+campaign+%E2%80%94%E2%80%94+1%24_9.21_Japanese_COPY_01&utm_medium=email&utm_term=0_4b071a49e3-9162fdf13c-49714817&ct=t()&mc_cid=9162fdf13c&mc_eid=3012c69022</li>
</ul>

<b>Notes:</b>

<ul>
<li> <a href="https://hackaday.com/2014/09/18/a-diy-midi-wind-controller/" target="_self"><tt>https://hackaday.com/2014/09/18/a-diy-midi-wind-controller/</tt></a></li>
<li> <a href="https://gonzos.net/projects/ewi-pi/" target="_self"><tt>https://gonzos.net/projects/ewi-pi/</tt></a></li>
<li> <a href="http://zynthian.org/" target="_self"><tt>http://zynthian.org/</tt></a></li>
<li> <a href="https://ewiusb.com/software" target="_self"><tt>https://ewiusb.com/software</tt></a></li>
</ul>

<!-- !split -->

<h1 id="___sec3">Motocomms </h1>
<b>Description:</b>
A simple and mostly off-the-shelf communication and audio system for helmets

<p>
<b>User Story:</b>
helmet comm units are stupid expensive and sound terrible. And are additive to road
noise. And clumsy to control and link. And vendor specific. And another thing to keep charged.
And dumb in concept: who's wants a 5 hr running conversation when we just need to communicate
when stopped at an intersection about which way to turn? I want a way to use my noise-reducing
earbuds with an off the shelf radio through my phone so that I can also hear music or GPS.
Also, I like to keep my phone in my jacket pocket so there are no dangling wires. But I don't
want to have to look at the radio to use it or worry about charging it before riding.

<p>
<b>Feature Set:</b>

<ol>
<li> Custom radio integration

<ol type="a"></li>
   <li> GMRS appears to offer best license-free cost-vs-performance, with usable range of a couple miles and cross-compatibility with FRS</li>
   <li> <a href="http://projects.somerlot.net/._RoboticsProjects016.html#___sec15" target="_self">Custom-built HAM radio?</a></li>
   <li> Mesh wifi?</li>
</ol>

<li> App-based mixer for phone for multi-audio stream management (GPS, music, and comms at once!)</li>
<li> Custom handlebar control to only activate mic during push-to-talk, or switch it to VOX for regular hands-free, or turn off music</li>
<li> Charging bracket</li>
<li> Cross-use capable for skiing, hiking, trekking, and emergencies that are out of cell range</li>
<li> Components that are cheap enough to keep spares of or available enough to find anywhere</li>
</ol>

<b>Phasing:</b>

<ol>
<li> Start with wired connectivity, with phone and radio in tank bag (done):

<ol type="a"></li>
   <li> <a href="https://www.youtube.com/watch?v=4U5ArX7J7ps" target="_self">Noise-cancelling earbuds</a> but mounting the microphone is the tricky bit</li>
   <li> Build <a href="https://www.monoprice.com/product?p_id=10146" target="_self">stereo-line mixer</a> to combine radio, phone, and earbuds</li> 
   <li> Add <a href="https://baofengtech.com/product/adapter-3-5mm/" target="_self">handlebar switch</a> to mic for PTT</li>
</ol>

<li> Add wireless integration

<ol type="a"></li>
   <li> Build radio mount with charge bracket</li>
   <li> Build custom Bluetooth audio adapter to connect radio to phone</li>
</ol>

</ol>

<b>BOM:</b>

<ul>
<li> TBD depending on radio</li>
</ul>

<b>Notes:</b>

<ul>
<li> Commercial offerings:</li>

<ul>
  <li> <a href="https://forums.radioreference.com/threads/would-a-gmrs-frs-radio-built-into-a-smartphone-or-battery-case-interest-you.394416/" target="_self"><tt>https://forums.radioreference.com/threads/would-a-gmrs-frs-radio-built-into-a-smartphone-or-battery-case-interest-you.394416/</tt></a></li>
  <li> <a href="https://gotenna.com/" target="_self"><tt>https://gotenna.com/</tt></a></li>
  <li> <a href="https://beartooth.com" target="_self"><tt>https://beartooth.com</tt></a></li>
</ul>

</ul>

<!-- !split -->

<h1 id="___sec4">Track GDD </h1>

<ol>
<li> Use a (google?) calendar of observations to track growing degree days

<ol type="a"></li>
   <li> User enters garden events on the google calendar when it happens (ie sunflowers bloom)</li>

<ol>
     <li> Next season the garden events are predicted</li>
     <li> can start off with a database of "known" GDD events (crops, etc)</li>
     <li> can track other seasonal things like honeybee activity, pest occurance, etc</li>
</ol>

   <li> The program uses an online API to pull daily min/max temperatures for user's locale and calculate GDD for each observed event from previous seasons</li>

<ol>
     <li> can use long-term temp forecasts to predict occurances of events</li>
     <li> Updates calendar of predicted events</li>
</ol>

   <li> Host on <a href="https://www.pythonanywhere.com/user/csomerlot/shares/d795cc4ade44422ea92ab1f1d43fab8e/" target="_self">pythonanywhere</a> as a web service</li>
</ol>

<li> References

<ol type="a"></li>
   <li> <a href="https://en.wikipedia.org/wiki/Growing_degree-day" target="_self">Calculating GDD</a></li>
</ol>

<li> Local temperature

<ol type="a"></li>
   <li> Onset datalogger</li>
   <li> <a href="https://rapidapi.com/darkskyapis/api/dark-sky/endpoints" target="_self">DarkSky API</a></li>
</ol>

</ol>

<!-- !split -->

<h1 id="___sec5">Tartan designer </h1>

<ol>
<li> A gui-based designer for weaving</li>
<li> A great use-case and teaching example of using graphics and Programming

<ol type="a"></li>
 <li> <a href="https://docs.python.org/3.3/library/turtle.html" target="_self"><tt>https://docs.python.org/3.3/library/turtle.html</tt></a></li>
</ol>

</ol>

<center> <!-- figure label: --> <div id="fig:tartan"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 2:  Sample output.  <!-- caption label: fig:tartan --> </p></center>
<p><img src="./code/TartanDesigner.py.png" align="bottom" width=600></p>
</center>

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">os</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">turtle</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">PIL</span> <span style="color: #008000; font-weight: bold">import</span> Image

DEBUG <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
w <span style="color: #666666">=</span> <span style="color: #666666">4</span>
c1 <span style="color: #666666">=</span> [(<span style="color: #666666">15</span>,<span style="color: #666666">15</span>,<span style="color: #666666">15</span>)]<span style="color: #666666">*2</span> <span style="color: #3D7B7B; font-style: italic">## colors are given by (R,G,B) value * number of threads</span>
c2 <span style="color: #666666">=</span> [(<span style="color: #666666">136</span>,<span style="color: #666666">0</span>,<span style="color: #666666">0</span>)]<span style="color: #666666">*14</span>
c3 <span style="color: #666666">=</span> [(<span style="color: #666666">0</span>,<span style="color: #666666">56</span>,<span style="color: #666666">32</span>)]<span style="color: #666666">*8</span>
c4 <span style="color: #666666">=</span> [(<span style="color: #666666">240</span>,<span style="color: #666666">240</span>,<span style="color: #666666">240</span>)]<span style="color: #666666">*4</span>
sett <span style="color: #666666">=</span> <span style="color: #008000">tuple</span>(c1 <span style="color: #666666">+</span> c2 <span style="color: #666666">+</span> c3 <span style="color: #666666">+</span> c4 <span style="color: #666666">+</span> c3 <span style="color: #666666">+</span> c2)<span style="color: #666666">*3</span>

maxDim <span style="color: #666666">=</span> <span style="color: #008000">len</span>(sett)<span style="color: #666666">*</span>w
<span style="color: #008000; font-weight: bold">if</span> DEBUG: <span style="color: #008000">print</span> (<span style="color: #008000">len</span>(sett), maxDim)
buffer <span style="color: #666666">=</span> <span style="color: #666666">20</span>
setup(width<span style="color: #666666">=</span>maxDim<span style="color: #666666">+</span>buffer, height<span style="color: #666666">=</span>maxDim<span style="color: #666666">+</span>buffer,startx<span style="color: #666666">=200</span>,starty<span style="color: #666666">=20</span>)
screensize(maxDim, maxDim)
setworldcoordinates(<span style="color: #666666">0</span>,maxDim,maxDim,<span style="color: #666666">0</span>)
<span style="color: #008000; font-weight: bold">if</span> DEBUG:
    <span style="color: #008000">print</span>(screensize())
<span style="color: #008000; font-weight: bold">if</span> screensize()[<span style="color: #666666">0</span>] <span style="color: #666666">!=</span> maxDim <span style="color: #AA22FF; font-weight: bold">or</span> screensize()[<span style="color: #666666">1</span>] <span style="color: #666666">!=</span> maxDim:
    <span style="color: #008000">print</span> (<span style="color: #BA2121">&quot;WARNING: Screensize is not set to the maxDim (</span><span style="color: #A45A77; font-weight: bold">{}</span><span style="color: #BA2121">), you likely have aspect warping. Try changing the buffer variable.&quot;</span><span style="color: #666666">.</span>format(maxDim))

width(w)
speed(<span style="color: #666666">10</span>)
tracer(<span style="color: #666666">2</span>)
colormode(<span style="color: #666666">255</span>)
register_shape(<span style="color: #BA2121">&quot;bar&quot;</span>,( (w<span style="color: #666666">/2</span>,<span style="color: #666666">0</span>),(<span style="color: #666666">-</span>(w<span style="color: #666666">/2</span>),<span style="color: #666666">0</span>),(<span style="color: #666666">-</span>(w<span style="color: #666666">/2</span>),<span style="color: #666666">2*</span>w),(w<span style="color: #666666">/2</span>,<span style="color: #666666">2*</span>w) ))
shape(<span style="color: #BA2121">&quot;bar&quot;</span>)
hideturtle()

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">tossShuttle</span>():
    <span style="color: #008000; font-weight: bold">if</span> heading() <span style="color: #666666">==</span> <span style="color: #666666">0.0</span>:
        left(<span style="color: #666666">90</span>)
        forward(w)
        left(<span style="color: #666666">90</span>)
        setx(maxDim)
    <span style="color: #008000; font-weight: bold">else</span>:
        right(<span style="color: #666666">90</span>)
        forward(w)
        right(<span style="color: #666666">90</span>)
        setx(<span style="color: #666666">0</span>)

<span style="color: #3D7B7B; font-style: italic">#warp</span>
home()
t2 <span style="color: #666666">=</span> Turtle()
t2<span style="color: #666666">.</span>width(<span style="color: #666666">1</span>)
t2<span style="color: #666666">.</span>home()
<span style="color: #008000; font-weight: bold">for</span> x, c <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">enumerate</span>(sett):
    penup()
    goto([x<span style="color: #666666">*</span>w<span style="color: #666666">-</span>w<span style="color: #666666">/2</span>, <span style="color: #666666">-3*</span>w])
    pendown()
    color(c)
    goto([x<span style="color: #666666">*</span>w<span style="color: #666666">-</span>w<span style="color: #666666">/2</span>, maxDim<span style="color: #666666">+3*</span>w])

    <span style="color: #3D7B7B; font-style: italic"># shade lines</span>
    t2<span style="color: #666666">.</span>penup()
    t2<span style="color: #666666">.</span>goto([x<span style="color: #666666">*</span>w<span style="color: #666666">-</span>w, <span style="color: #666666">-3*</span>w])
    t2<span style="color: #666666">.</span>pendown()
    t2<span style="color: #666666">.</span>color([<span style="color: #008000">int</span>(<span style="color: #666666">0.8*</span>x) <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> c])
    t2<span style="color: #666666">.</span>goto([x<span style="color: #666666">*</span>w<span style="color: #666666">-</span>w, maxDim<span style="color: #666666">+3*</span>w])
penup()


<span style="color: #3D7B7B; font-style: italic">#weft</span>
home()
treadle <span style="color: #666666">=</span> <span style="color: #666666">0</span>
<span style="color: #008000; font-weight: bold">for</span> x, c <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">enumerate</span>(sett):
    <span style="color: #3D7B7B; font-style: italic"># color(&quot;&quot;, c)</span>
    color([<span style="color: #008000">int</span>(<span style="color: #666666">0.8*</span>x) <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> c], c)
    forward(treadle<span style="color: #666666">*</span>w)

    <span style="color: #3D7B7B; font-style: italic"># if DEBUG: print(&quot;Heading: {0:5}, Treadle: {2}, Coords: {1}&quot;.format(heading(), pos(), treadle))</span>

    <span style="color: #008000; font-weight: bold">while</span> <span style="color: #666666">0</span> <span style="color: #666666">&lt;=</span> xcor() <span style="color: #666666">&lt;</span> maxDim:
        stamp()
        forward(<span style="color: #666666">4*</span>w)
    tossShuttle()
    treadle <span style="color: #666666">+=1</span>
    <span style="color: #008000; font-weight: bold">if</span> treadle <span style="color: #666666">&gt;</span> <span style="color: #666666">3</span>: treadle <span style="color: #666666">=</span> <span style="color: #666666">0</span>

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> DEBUG:
    <span style="color: #008000; font-weight: bold">try</span>:
        getcanvas()<span style="color: #666666">.</span>postscript(file<span style="color: #666666">=</span><span style="color: #19177C">__file__</span><span style="color: #666666">+</span><span style="color: #BA2121">&quot;.eps&quot;</span>, colormode<span style="color: #666666">=</span><span style="color: #BA2121">&#39;color&#39;</span>)
        Image<span style="color: #666666">.</span>open(<span style="color: #19177C">__file__</span><span style="color: #666666">+</span><span style="color: #BA2121">&quot;.eps&quot;</span>)<span style="color: #666666">.</span>save(<span style="color: #19177C">__file__</span><span style="color: #666666">+</span><span style="color: #BA2121">&quot;.png&quot;</span>)
        os<span style="color: #666666">.</span>startfile(<span style="color: #19177C">__file__</span><span style="color: #666666">+</span><span style="color: #BA2121">&quot;.png&quot;</span>)
    <span style="color: #008000; font-weight: bold">except</span> <span style="color: #CB3F38; font-weight: bold">IOError</span>:
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;cannot save image&quot;</span>)

exitonclick()
</pre></div>
<p>
<!-- !split -->

<h1 id="___sec6">Somerlot Shooting Support System (S4) </h1>

<ol>
<li> Basic ballistics calc to support F-Class gun (drop and windage)

<ol type="a"></li>
 <li> <a href="https://pypi.org/project/ballistics/" target="_self">Trajectory Science lib</a></li>
</ol>

<li> Based on computed and measured ballistic performance

<ol type="a"></li>
 <li> Empirical test data to refine bullet drag and air density coefficients</li>
</ol>

<li> Integrate with GPS, mapping, online weather stations, USB weather station</li>
</ol>

<!-- !split -->

<h1 id="___sec7">Retail support tools </h1>

<h2 id="___sec8">Scheduler </h2>

<ol>
<li> Rule-based genetic algorithm optimizer</li>
</ol>

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">csv</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">pprint</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">random</span>

Population_Size <span style="color: #666666">=</span> <span style="color: #666666">5000</span>
Litter_Size <span style="color: #666666">=</span> <span style="color: #666666">3</span>
Mutation_Rate <span style="color: #666666">=</span> <span style="color: #666666">5</span>

week <span style="color: #666666">=</span> [<span style="color: #BA2121">&quot;Sunday&quot;</span>, <span style="color: #BA2121">&quot;Monday&quot;</span>, <span style="color: #BA2121">&quot;Tuesday&quot;</span>, <span style="color: #BA2121">&quot;Wednesday&quot;</span>, <span style="color: #BA2121">&quot;Thursday&quot;</span>, <span style="color: #BA2121">&quot;Friday&quot;</span>, <span style="color: #BA2121">&quot;Saturday&quot;</span>]
shifts <span style="color: #666666">=</span> [<span style="color: #BA2121">&quot;Morning&quot;</span>, <span style="color: #BA2121">&quot;Afternoon&quot;</span>, <span style="color: #BA2121">&quot;Evening&quot;</span>]

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">fitness_score</span>(schedule, rules):
    score <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #3D7B7B; font-style: italic"># Rules by schedule</span>
    
    <span style="color: #3D7B7B; font-style: italic"># check at least 1 person has keys for open and close</span>
    
    
    
    
    <span style="color: #3D7B7B; font-style: italic"># Rules by person</span>
    <span style="color: #008000; font-weight: bold">for</span> emp <span style="color: #AA22FF; font-weight: bold">in</span> schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>]:
        <span style="color: #3D7B7B; font-style: italic"># print emp</span>
        <span style="color: #3D7B7B; font-style: italic"># check total</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">len</span>(schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>][emp]) <span style="color: #666666">&gt;</span> rules[emp][<span style="color: #BA2121">&quot;ShiftsPerWeek&quot;</span>]: 
            score<span style="color: #666666">+=</span> <span style="color: #008000">len</span>(schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>][emp]) <span style="color: #666666">-</span> rules[emp][<span style="color: #BA2121">&quot;ShiftsPerWeek&quot;</span>]
            <span style="color: #3D7B7B; font-style: italic"># print &quot;\tToo many shifts&quot;, score</span>
        
        weekend <span style="color: #666666">=</span> <span style="color: #666666">0</span>
        morning <span style="color: #666666">=</span> <span style="color: #666666">0</span>
        afternn <span style="color: #666666">=</span> <span style="color: #666666">0</span>
        evening <span style="color: #666666">=</span> <span style="color: #666666">0</span>
        <span style="color: #008000; font-weight: bold">for</span> shift_desc <span style="color: #AA22FF; font-weight: bold">in</span> schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>][emp]:
                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">&quot;Saturday&quot;</span>  <span style="color: #AA22FF; font-weight: bold">in</span> shift_desc <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #BA2121">&quot;Sunday&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> shift_desc: weekend<span style="color: #666666">+=1</span>
                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">&quot;Morning&quot;</span>   <span style="color: #AA22FF; font-weight: bold">in</span> shift_desc: morning<span style="color: #666666">+=1</span>
                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">&quot;Afternoon&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> shift_desc: afternn<span style="color: #666666">+=1</span>
                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">&quot;Evening&quot;</span>   <span style="color: #AA22FF; font-weight: bold">in</span> shift_desc: evening<span style="color: #666666">+=1</span>
                
        <span style="color: #3D7B7B; font-style: italic"># check works weekends</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> rules[emp][<span style="color: #BA2121">&quot;WorksWeekends&quot;</span>]: 
            score<span style="color: #666666">+=</span>weekend
            <span style="color: #3D7B7B; font-style: italic"># print &quot;\tNo weekends&quot;, score</span>
            
        <span style="color: #3D7B7B; font-style: italic"># check morning, afternoon, evening shift</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> rules[emp][<span style="color: #BA2121">&quot;WorksMornings&quot;</span>]: 
            score<span style="color: #666666">+=</span>morning
            <span style="color: #3D7B7B; font-style: italic"># print &quot;\tMornings bad&quot;, score</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> rules[emp][<span style="color: #BA2121">&quot;WorksAfternoons&quot;</span>]: 
            score <span style="color: #666666">+=</span>afternn
            <span style="color: #3D7B7B; font-style: italic"># print &quot;\tAfternoons bad&quot;, score</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> rules[emp][<span style="color: #BA2121">&quot;WorksEvenings&quot;</span>]: 
            score <span style="color: #666666">+=</span>evening
            <span style="color: #3D7B7B; font-style: italic"># print &quot;\tEvenings bad&quot;, score</span>
            
        <span style="color: #3D7B7B; font-style: italic"># check only back-to-back double shifts</span>
    <span style="color: #3D7B7B; font-style: italic"># print </span>
    <span style="color: #008000; font-weight: bold">return</span> score

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">getRules</span>(url):
    rules <span style="color: #666666">=</span> {}
    <span style="color: #008000; font-weight: bold">with</span> file(url, <span style="color: #BA2121">&#39;rb&#39;</span>) <span style="color: #008000; font-weight: bold">as</span> csvFile:
        data <span style="color: #666666">=</span> csv<span style="color: #666666">.</span>DictReader(csvFile)

        <span style="color: #008000; font-weight: bold">for</span> row <span style="color: #AA22FF; font-weight: bold">in</span> data:
            rules[row[<span style="color: #BA2121">&#39;Employee&#39;</span>]] <span style="color: #666666">=</span> {}
            <span style="color: #008000; font-weight: bold">for</span> k <span style="color: #AA22FF; font-weight: bold">in</span> row:
                val <span style="color: #666666">=</span> row[k]
                <span style="color: #008000; font-weight: bold">if</span> val <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;TRUE&#39;</span>: val <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
                <span style="color: #008000; font-weight: bold">if</span> val <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;FALSE&#39;</span>: val <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
                <span style="color: #008000; font-weight: bold">try</span>:
                    val <span style="color: #666666">=</span> <span style="color: #008000">int</span>(val)
                <span style="color: #008000; font-weight: bold">except</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>:
                    <span style="color: #008000; font-weight: bold">pass</span>
                rules[row[<span style="color: #BA2121">&#39;Employee&#39;</span>]][k] <span style="color: #666666">=</span> val
    <span style="color: #008000; font-weight: bold">return</span> rules
    
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">mutate</span>(individual):
    <span style="color: #008000; font-weight: bold">for</span> gene <span style="color: #AA22FF; font-weight: bold">in</span> individual[<span style="color: #BA2121">&quot;gene_dict&quot;</span>]:
        <span style="color: #008000; font-weight: bold">if</span> random<span style="color: #666666">.</span>randint(<span style="color: #666666">0</span>,<span style="color: #666666">100</span>) <span style="color: #666666">&lt;=</span> Mutation_Rate:
            individual[<span style="color: #BA2121">&quot;gene_dict&quot;</span>][gene] <span style="color: #666666">=</span> random<span style="color: #666666">.</span>randint(<span style="color: #666666">1</span>,<span style="color: #666666">9</span>)
    <span style="color: #3D7B7B; font-style: italic">#individual[&quot;fitness&quot;] = fitness_score(individual[&quot;gene_dict&quot;])</span>
    <span style="color: #008000; font-weight: bold">return</span> individual

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">mortality</span>(population): <span style="color: #3D7B7B; font-style: italic">#sort individuals (list by fitness score), kill off least fit</span>
    sortedPop <span style="color: #666666">=</span> <span style="color: #008000">sorted</span>(population) <span style="color: #3D7B7B; font-style: italic">#sorted function accepts any iterable, where list.sort does not</span>
    <span style="color: #008000; font-weight: bold">return</span> sortedPop[:Population_Size]

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">reproduction</span>(population, rules):
    nextGen <span style="color: #666666">=</span> []
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(population)<span style="color: #666666">/2</span>):
        parent_1 <span style="color: #666666">=</span> random<span style="color: #666666">.</span>choice(population)
        parent_2 <span style="color: #666666">=</span> random<span style="color: #666666">.</span>choice(population)
<span style="color: #3D7B7B; font-style: italic">##        while parent_1 == parent_2:</span>
<span style="color: #3D7B7B; font-style: italic">##            parent_2 = random.choice(population)</span>

        <span style="color: #008000; font-weight: bold">for</span> offspring <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(Litter_Size):
        
            schedule <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;ByDay&quot;</span>:{}, <span style="color: #BA2121">&quot;ByPerson&quot;</span>:{}}
            
            <span style="color: #008000; font-weight: bold">for</span> day <span style="color: #AA22FF; font-weight: bold">in</span> week:
                schedule[<span style="color: #BA2121">&quot;ByDay&quot;</span>][day] <span style="color: #666666">=</span> {}
                <span style="color: #008000; font-weight: bold">for</span> shift <span style="color: #AA22FF; font-weight: bold">in</span> shifts:
                    schedule[<span style="color: #BA2121">&quot;ByDay&quot;</span>][day][shift] <span style="color: #666666">=</span> []
                    desc <span style="color: #666666">=</span> day <span style="color: #666666">+</span> <span style="color: #BA2121">&quot; &quot;</span> <span style="color: #666666">+</span> shift
                    <span style="color: #008000; font-weight: bold">for</span> p <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">2</span>):
                        parent <span style="color: #666666">=</span> random<span style="color: #666666">.</span>choice(population)
                        person <span style="color: #666666">=</span> random<span style="color: #666666">.</span>choice(parent[<span style="color: #666666">1</span>][<span style="color: #BA2121">&quot;ByDay&quot;</span>][day][shift])
                        <span style="color: #008000; font-weight: bold">while</span> person <span style="color: #AA22FF; font-weight: bold">in</span> schedule[<span style="color: #BA2121">&quot;ByDay&quot;</span>][day][shift]:
                            parent <span style="color: #666666">=</span> random<span style="color: #666666">.</span>choice(population)
                            person <span style="color: #666666">=</span> random<span style="color: #666666">.</span>choice(parent[<span style="color: #666666">1</span>][<span style="color: #BA2121">&quot;ByDay&quot;</span>][day][shift])
                        schedule[<span style="color: #BA2121">&quot;ByDay&quot;</span>][day][shift]<span style="color: #666666">.</span>append(person)
                        <span style="color: #008000; font-weight: bold">if</span> person <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #AA22FF; font-weight: bold">in</span> schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>]:
                            schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>][person] <span style="color: #666666">=</span> []
                        schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>][person]<span style="color: #666666">.</span>append(desc)
                    
            fitness <span style="color: #666666">=</span> fitness_score(schedule, rules)
            
            nextGen<span style="color: #666666">.</span>append((fitness, schedule))
    <span style="color: #008000; font-weight: bold">return</span> nextGen
    
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">makeRandomSchedule</span>(rules):
    schedule <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;ByDay&quot;</span>:{}, <span style="color: #BA2121">&quot;ByPerson&quot;</span>:{}}
    employees <span style="color: #666666">=</span> rules<span style="color: #666666">.</span>keys()
    <span style="color: #008000; font-weight: bold">for</span> day <span style="color: #AA22FF; font-weight: bold">in</span> week:
        schedule[<span style="color: #BA2121">&quot;ByDay&quot;</span>][day] <span style="color: #666666">=</span> {}
        <span style="color: #008000; font-weight: bold">for</span> shift <span style="color: #AA22FF; font-weight: bold">in</span> shifts:
            schedule[<span style="color: #BA2121">&quot;ByDay&quot;</span>][day][shift] <span style="color: #666666">=</span> []
            desc <span style="color: #666666">=</span> day <span style="color: #666666">+</span> <span style="color: #BA2121">&quot; &quot;</span> <span style="color: #666666">+</span> shift
            <span style="color: #008000; font-weight: bold">for</span> p <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">2</span>):
                person <span style="color: #666666">=</span> random<span style="color: #666666">.</span>choice(employees)
                <span style="color: #008000; font-weight: bold">while</span> person <span style="color: #AA22FF; font-weight: bold">in</span> schedule[<span style="color: #BA2121">&quot;ByDay&quot;</span>][day][shift]:
                    person <span style="color: #666666">=</span> random<span style="color: #666666">.</span>choice(employees)
                schedule[<span style="color: #BA2121">&quot;ByDay&quot;</span>][day][shift]<span style="color: #666666">.</span>append(person)
                <span style="color: #008000; font-weight: bold">if</span> person <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #AA22FF; font-weight: bold">in</span> schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>]:
                    schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>][person] <span style="color: #666666">=</span> []
                schedule[<span style="color: #BA2121">&quot;ByPerson&quot;</span>][person]<span style="color: #666666">.</span>append(desc)
            
    fitness <span style="color: #666666">=</span> fitness_score(schedule, rules)
    
    <span style="color: #008000; font-weight: bold">return</span> fitness, schedule
    
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">evolve</span>(rules):

    <span style="color: #3D7B7B; font-style: italic"># make initial random population</span>
    population <span style="color: #666666">=</span> []
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(Population_Size<span style="color: #666666">+1</span>):
        population<span style="color: #666666">.</span>append(makeRandomSchedule(rules))
    best <span style="color: #666666">=</span> <span style="color: #008000">sorted</span>(population)[<span style="color: #666666">0</span>][<span style="color: #666666">0</span>]
    
    <span style="color: #3D7B7B; font-style: italic"># main evolution loop </span>
    GenerationCount <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">while</span> best <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        newpop <span style="color: #666666">=</span> mortality(population)
        population <span style="color: #666666">=</span> <span style="color: #008000">sorted</span>(newpop <span style="color: #666666">+</span> reproduction(newpop, rules))
        best <span style="color: #666666">=</span> population[<span style="color: #666666">0</span>][<span style="color: #666666">0</span>]
        GenerationCount <span style="color: #666666">+=1</span>
        <span style="color: #008000">print</span> GenerationCount, best
    
    pprint<span style="color: #666666">.</span>pprint(population[<span style="color: #666666">0</span>][<span style="color: #666666">1</span>])
    
<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">__name__</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    rules <span style="color: #666666">=</span> getRules(<span style="color: #BA2121">&quot;https://docs.google.com/spreadsheets/d/1IvTSl58Angp1-4FTa40G_7dn3hJZPZtCXY63oiLOJJ8/pub?gid=0&amp;single=true&amp;output=tsv&quot;</span>)
    evolve(rules)
</pre></div>

<h2 id="___sec9">Rewards Program Calculator </h2>

<ol>
<li> Description

<ol type="a"></li>
   <li> This application was developed to track customer spending, in order to determine eligibility for rewards certificates. It relies on data exported from the POS system, and does not in any way touch any databases.</li>
</ol>

<li> Usage

<ol type="a"></li>
   <li> Overview</li>

<ol>
       <li> Assuming that you created the spreadsheet correctly, usage is pretty self explanatory. There are only 3 buttons. However,</li>
</ol>

        if the application crashes, it should prompt you to automatically send an error report via email to the developer (Chris).
   <li> Input</li>

<ol>
       <li> This application reads in an excel spreadsheet that was exported from the EaglePOS system, which must include sales YTD</li>
</ol>

        for each customer, as well as mailing info. If the application can't find the necessary data, it should let you know.
   <li> Output</li>

<ol>
       <li> This is the secret part, and will be filled in later.</li>
</ol>

</ol>

<li> <a href="https://s3.amazonaws.com/projects.somerlot.net/Programming/setup.exe" target="_self">Download installer</a> (if you have permissions)</li>
</ol>

<!-- !split -->

<h1 id="___sec10">Homemade Variable Frequency Drive </h1>

<p>
<b>Description:</b>
VFDs really help manage motor performance, and life span. A well pump works much better when on a VFD.

<p>
<!-- __User Story:__ -->
<!-- __Feature Set:__ -->

<ol>
<li> Open-source hardware, with spares parts
<!-- __Phasing:__ -->
<!-- * -->
<!-- __BOM:__ -->
<!-- o --></li>
</ol>

<b>Notes:</b>

<ul>
<li> <a href="https://www.homemade-circuits.com/3-phase-vfd-circuit/" target="_self"><tt>https://www.homemade-circuits.com/3-phase-vfd-circuit/</tt></a>
<!-- __Code:__ -->
<!-- @@@CODE ./filepath envir=Xpro -->
<!-- FIGURE: [path, width=900 frac=0.9] Something. <div id="fig:temp"></div> --></li>
</ul>

<!-- !split -->


<center><h1>Internet-of-Things Projects</h1></center>  <!-- document title -->

<h1 id="table_of_contents">Table of contents</h2>

<p>
<a href="#___sec0"> Robotics Club Setup </a><br>
<a href="#___sec1"> Home Internet Gateway </a><br>
<a href="#___sec2"> Arduino Wind Instrument </a><br>
<a href="#___sec3"> Motocomms </a><br>
<a href="#___sec4"> Track GDD </a><br>
<a href="#___sec5"> Tartan designer </a><br>
<a href="#___sec6"> Somerlot Shooting Support System (S4) </a><br>
<a href="#___sec7"> Retail support tools </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec8"> Scheduler </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec9"> Rewards Program Calculator </a><br>
<a href="#___sec10"> Homemade Variable Frequency Drive </a><br>
<a href="#___sec11"> Common Mobile Compute Platform </a><br>
<a href="#___sec12"> Domotics </a><br>
<a href="#___sec13"> Automotive Media System </a><br>
<a href="#___sec14"> GPS Chartplotter </a><br>
<a href="#___sec15"> Common Sensor and Datalogger Platform </a><br>
<a href="#___sec16"> Micro Hydroponics </a><br>
<a href="#___sec17"> Technology as Art </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec18"> Wood Burning Plotter </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec19"> Lightning Catcher </a><br>
<a href="#___sec20"> Irrigation Remote </a><br>
<a href="#___sec21"> The Best Damn Radio System </a><br>
<a href="#___sec22"> Fixed Wing UAV </a><br>
<a href="#___sec23"> Submersible / Surface ROV </a><br>
<a href="#___sec24"> Pool Octobot </a><br>
<a href="#___sec25"> Scarecrow Targeting System </a><br>
<a href="#___sec26"> Invasive Species Patroller </a><br>
<a href="#___sec27"> Signal-Tracking Antenna Mount </a><br>
</p>
<p>
CircuitPython rules! Arduino drools! Let them eat RaspberryPi!

<p>
<!-- !split -->

<h1 id="___sec11">Common Mobile Compute Platform </h1>
<b>Description:</b>
A toolbox platform for sensors and communications built around the venerable RPi.

<p>
<b>BOM:</b>

<ul>
<li> <a href="https://www.adafruit.com/category/1000" target="_self">RPi</a> with SD card and power supply. 3b+ is best model while v4 gets debugged.</li>
<li> Power</li>

<ul>
  <li> <a href="https://www.adafruit.com/product/3196" target="_self">Battery</a></li>
  <li> <a href="https://www.adafruit.com/product/3953" target="_self">PoE</a></li>
</ul>

<li> Interface</li>

<ul>
  <li> <a href="https://www.adafruit.com/product/2441" target="_self">Tiny touchscreen</a></li>
  <li> <a href="https://www.adafruit.com/product/3527" target="_self">Minimal OLED</a></li>
  <li> <a href="https://www.adafruit.com/product/1115" target="_self">LCD</a></li>
</ul>

<li> RTC: without this logs and data collection is useless</li>

<ul>
  <li> <a href="https://www.adafruit.com/product/3386" target="_self">cheap option</a></li>
  <li> <a href="https://www.adafruit.com/product/4282" target="_self">good option</a></li>
</ul>

<li> SDR:</li>

<ul>
  <li> <a href="https://www.adafruit.com/product/1497" target="_self">cheap option</a></li>
  <li> <a href="https://www.adafruit.com/product/3583" target="_self">plan B option</a></li>
</ul>

<li> Wifi:</li>

<ul>
  <li> <a href="https://www.adafruit.com/product/1030" target="_self">cheap option</a></li>
  <li> <a href="https://www.alfa.com.tw/products_detail/8.htm" target="_self">Long-range</a></li>
</ul>

<li> Location:</li>

<ul>
  <li> <a href="https://www.adafruit.com/product/2324" target="_self">GPS</a></li>
  <li> <a href="https://www.adafruit.com/product/4754" target="_self">IMU</a></li>
</ul>

</ul>

<b>Notes:</b>

<ul>
<li> Similar to the <a href="https://www.adafruit.com/product/3762" target="_self">PiTop</a>, with a compact housing</li>
</ul>

<!-- !split -->

<h1 id="___sec12">Domotics </h1>
<b>Description:</b>
Living in a house of the future is either a great idea or a terrible idea...

<p>
<b>User Story:</b>
So many touch-points of our environment involve mechanical systems in our dwellings, it seems both obvious and inevitable to connect these systems to a computing platform to live a less impactful life.

<p>
<b>Feature Set:</b>

<ol>
<li> Sensors

<ol type="a"></li>
   <li> Interior</li>

<ol>
       <li> Temperature and humidity of each room</li>
       <li> nonintrusive appliance load monitor

<ol type="a"></li>
           <li> Current sensors</li>
           <li> Voltage Sensors</li>
           <li> Circuit design</li>

<ol>
               <li> Conceptual description = voltage and current translated to correct range for ADC, goes to ADC, ADC interface with GPIO I2C or SPI bus via isolation</li>
</ol>

</ol>

       <li> Salt level</li>
       <li> Water pressure and flow</li>
       <li> Propane level via pressure sensor</li>
       <li> Air cleaner</li>
       <li> Smoke / CO / Propane</li>
       <li> Forced entry (pressure change)</li>
       <li> Family presence (RFID)</li>
       <li> Woodstove temp</li>
      <li> Roomba status</li>
</ol>

  <li> Exterior</li>

<ol>
       <li> Rain</li>
       <li> Soil moisture</li>
       <li> Sunshine</li>
       <li> Wind</li>
       <li> Temp</li>
       <li> Snowfall</li>
       <li> Humidity</li>
       <li> Motion detectors</li>
       <li> Water table depth</li>
</ol>

</ol>

<li> Controls

<ol type="a"></li>
   <li> Heat pump</li>
   <li> Window Fans</li>
   <li> Lights</li>
   <li> Power failure</li>
   <li> Patio snow melter</li>
   <li> Humidifier / dehumidifier</li>
   <li> Irrigation</li>
   <li> Access (electric door strike)</li>
   <li> Wood Stove blower</li>

<ol>
       <li> Stepper motor-controled rheostat</li>
</ol>

</ol>

<li> Server

<ol type="a"></li>
   <li> Integrations</li>

<ol>
       <li> Thermostat interface with LCD hat</li>
       <li> NILM data logger</li>
       <li> Wifi Router and print server</li>
</ol>

   <li> <a href="https://www.home-assistant.io/" target="_self"><tt>https://www.home-assistant.io/</tt></a></li>
</ol>

</ol>

<b>BOM:</b>

<ul>
    <li> <a href="/._ComputerProjects010.html#___sec10" target="_self">Common Mobile Compute Platform</a></li>
</ul>

<!-- !split -->

<h1 id="___sec13">Automotive Media System </h1>
<b>Description:</b>
a simple media system to stream movies and provide Android auto connectivity

<p>
<b>User Story:</b>
Car audio has become increasingly complex when it doesn't need to be. Android Auto
can provide a great in-car experience, but all the 3rd-party AA receivers are expensive.

<p>
<b>Feature Set:</b>

<ol>
<li> Android Auto</li>
<li> Media network share</li>
<li> SDR for radio (and everything else RF):

<ol type="a"></li>
   <li> FM radio with station/song info</li>
   <li> Weather Band/Fax</li>
   <li> Police scanner</li>
   <li> SSB</li>
</ol>

<li> ODBII integration:

<ol type="a"></li>
   <li> Logging</li>
   <li> Alternate dashboard displays</li>
</ol>

<li> UI/Controls:

<ol type="a"></li>
   <li> Macro and micro tuner wheels: for quickly moving through either the spectrum or file list selection sets</li>
   <li> Touchscreen for configurable selection controls</li>
</ol>

<li> External:

<ol type="a"></li>
   <li> Engine start?</li>
   <li> GPS tracking</li>
</ol>

</ol>

<b>Phasing:</b>

<ol>
<li> Build RPi software stack</li>
<li> Integrate touch screen, push buttons, and dials</li>
<li> Integrate peripheral hardware: SDR, HD, microphone</li>
<li> Integrate 6-channel amplifier and stereo hat</li>
<li> Build housing</li>
<li> Build wiring harness</li>
<li> Install</li>
</ol>

<b>BOM:</b>

<ul>
<li> <a href="/._ComputerProjects010.html#___sec10" target="_self">Common Mobile Compute Platform</a></li>
<li> <a href="https://www.adafruit.com/product/1752" target="_self"><tt>https://www.adafruit.com/product/1752</tt></a></li>
</ul>

<b>Notes:</b>

<ul>
<li> <a href="https://www.zdnet.com/article/raspberry-pi-goes-android-auto-now-you-can-build-your-own-cheap-car-head-unit/" target="_self"><tt>https://www.zdnet.com/article/raspberry-pi-goes-android-auto-now-you-can-build-your-own-cheap-car-head-unit/</tt></a></li>
<li> <a href="http://i-carus.com/" target="_self"><tt>http://i-carus.com/</tt></a></li>
<li> <a href="https://learn.adafruit.com/freq-show-raspberry-pi-rtl-sdr-scanner/overview" target="_self"><tt>https://learn.adafruit.com/freq-show-raspberry-pi-rtl-sdr-scanner/overview</tt></a></li>
<li> <a href="https://othernet.is/" target="_self"><tt>https://othernet.is/</tt></a></li>
<li> <a href="https://magpi.raspberrypi.org/articles/android-auto-openauto" target="_self"><tt>https://magpi.raspberrypi.org/articles/android-auto-openauto</tt></a></li>
</ul>

<!-- !split -->

<h1 id="___sec14">GPS Chartplotter </h1>
<b>Description:</b>
A mobile mapping solution for use in car, boat, or bike

<p>
<b>User Story:</b>
A digital map has more to offer than hard-copy, but also, this is just my wheelhouse. BGM seems to have 
largely captured the marine market, and android auto/apple car play for the automotive market, but these are 
still proprietary and limited in scope. I want selective sensor integration from a variety of environments and
COTS hardware.

<p>
<b>Feature Set:</b>

<ol>
<li> Touchscreen</li>
<li> Ruggedized:

<ol type="a"></li>
 <li> Pot into silicone</li>
 <li> Shock abosrbing case</li>
 <li> Mineral oil bath</li>
</ol>

<li> Multi-domain navigational integration:

<ol type="a"></li>
 <li> aGPS w/ WAAS</li>
 <li> inertial</li>
 <li> LORAN/beacon</li>
</ol>

<li> Sensors:

<ol type="a"></li>
 <li> sidescan sonar</li>
 <li> depth finder</li>
 <li> radar
<!-- __Phasing:__ -->
<!-- * --></li>
</ol>

</ol>

<b>BOM:</b>

<ul>
<li> <a href="/._ComputerProjects010.html#___sec10" target="_self">Common Mobile Compute Platform</a>
<!-- __Notes:__ -->
<!-- * --></li>
</ul>

<!-- !split -->

<h1 id="___sec15">Common Sensor and Datalogger Platform </h1>
<b>Description:</b>
Portable and wireless environmental IoT sensor and datalogger

<p>
<b>User Story:</b>
We want to be able measure a variety of environmental conditions, without hooking up wiring. We can place a sensor indoors or outdoors just for
spot checks or leave it for several weeks or add a solar power pack for permanent power. We can hook it up to a dashboard to monitor and
provide alarms, or use it in more remote conditions and have it upload once wifi is available, or use a cell modem. Some possible applications include:

<ul>
<li> Dive computer</li>
<li> Bike computer</li>
<li> Drone computer</li>
<li> Weather Balloon computer</li>
<li> Environmental Datalogger</li>
<li> Marine Chartplotter</li>
<li> Indoor air quality</li>
<li> Energy Monitor</li>
<li> Domotics, solar, or hydroponics controller</li>
</ul>

<b>Feature Set:</b>

<ul>
<li> Internet connection discovery and automatic frequent communication</li>
<li> Plenty of digital and analog inputs</li>
<li> LCD Screen and a few buttons for basic status and config</li>
<li> 2-week battery life</li>
<li> Watertight potting and enclosure (100m)</li>
<li> Shock-proof (shotgun at 10m)</li>
<li> ports for display, antenna, power, and USB</li>
<li> Wifi as base networking capability, with CDMA, Ham (APRS transmitter) and LoRa communications as options</li>
</ul>

<b>Phasing:</b>

<ul>
<li> Base unit build-out and config</li>
<li> develop ports</li>
<li> ruggedize</li>
</ul>

<b>BOM:</b>

<ul>
<li> Base Unit: <a href="https://www.adafruit.com/product/5303" target="_self">Adafruit Feather0</a></li>
<li> Base Unit: <a href="https://www.adafruit.com/product/353" target="_self">Lithium Ion Battery Pack - 3.7V 6600mAh</a></li>
<li> Base Unit: <a href="https://www.adafruit.com/product/2900" target="_self">Adafruit FeatherWing OLED - 128x32 OLED Add-on For Feather</a></li>
<li> <a href="https://www.adafruit.com/product/3709" target="_self">Air Quality and Gas Sensor</a></li>
<li> <a href="https://www.digikey.com/products/en?keywords=165D6042P003" target="_self">Water turbidity and temp</a></li>
<li> <a href="https://www.digikey.com/products/en?keywords=480-6244-ND" target="_self">Water pressure</a></li>
<li> <a href="https://tinyurl.com/y4jmsg6z" target="_self">Non-intrusive current sensors</a></li>
</ul>

<b>Notes:</b>

<ul>
<li> <a href="https://io.adafruit.com/" target="_self">Adafruit.io</a> for dashboard and short-term data warehousing</li>
<li> <a href="https://learn.adafruit.com/make-it-data-log-spreadsheet-circuit-playground" target="_self"><tt>https://learn.adafruit.com/make-it-data-log-spreadsheet-circuit-playground</tt></a></li>
<li> <a href="https://thecavepearlproject.org/" target="_self"><tt>https://thecavepearlproject.org/</tt></a></li>
<li> <a href="https://learn.adafruit.com/remote-iot-environmental-sensor/overview" target="_self"><tt>https://learn.adafruit.com/remote-iot-environmental-sensor/overview</tt></a></li>
<li> <a href="https://learn.adafruit.com/quickstart-adafruit-io-wippersnapper" target="_self">WipperSnapper</a> greatly simplifies everything!</li>
</ul>

<!-- !split -->

<h1 id="___sec16">Micro Hydroponics </h1>
<b>Description:</b>
Small air pump-based flood irrigation system for office plants

<p>
<b>User Story:</b>
Offices are great places for plants, with ample windows and beneficial effects for workers. But, regular watering can be an issue.

<p>
<b>Feature Set:</b>

<ol>
<li> Flood-based system of irrigation with emergency overflow

<ol type="a"></li>
   <li> Air pump inflates bladder, raises solution level, opens ARV to deflate and drop level</li>
   <li> 16" max head = 0.6 PSI</li>
</ol>

<li> Planting cells to allow co-planting but easy replacement/management

<ol type="a"></li>
   <li> Pre-made rock wool blocks available locally</li>
</ol>

<li> 14 day hands-off and quiet operation

<ol type="a"></li>
   <li> Water uptake/usage increases air volume needed to achieve same fluid level, requiring level sensors</li>
</ol>

<li> Water level and quality sensors, media moisture for SmartUtility demonstration via dashboard

<ol type="a"></li>
   <li> Water and energy usage, solution level and nutrient strength</li>
   <li> Back-calculate media moisture based on the timing of flooding and the drain-back volume?</li>
</ol>

<li> Low voltage and redundant level sensor

<ol type="a"></li>
   <li> Pressure sensor for full range and eTape for top 12"</li>
</ol>

<li> Attractive as office decor</li>
</ol>

<b>Phasing:</b>

<ol>
<li> Build sensor and ARV mechanicals

<ol type="a"></li>
   <li> Mount tape and air feed and pressure feed to stick, with ARV and pressure sensor at top</li>
   <li> Assemble and encase feather near power supply</li>
</ol>

<li> Install base controller logic</li>
<li> Build server script that runs flood routine based on MQTT events</li>
<li> Build flood tank with rock wool planting cells</li>
<li> triple-tote system:

<ol type="a"></li>
   <li> Media tray</li>

<ol>
       <li> Notches in bottom edge for drainage</li>
       <li> Anchoring for rock wool cubes

<ol type="a"></li>
           <li> brass screws along rim, to strech rubber bands over?</li>
</ol>

</ol>

   <li> Solution tank</li>

<ol>
       <li> Air line running into 1 large ballon

<ol type="a"></li>
         <li> multiple balloons make multiple points of failure, plus don't inflate equally</li>
</ol>

       <li> Latch media tray in place to avoid flotation</li>
       <li> Thru-hole for overflow port</li>
</ol>

   <li> Overflow tank</li>

<ol>
       <li> Captures leaks or overflows</li>
       <li> Removal with handle for general purpose use</li>
</ol>

</ol>

<li> Open-top cabinet on casters to hold everything and make pretty</li>
</ol>

<b>BOM:</b>

<ul>
<li> <a href="http://adafru.it/3619" target="_self">Adafruit ESP32 Feather</a></li>
<li> <a href="https://www.adafruit.com/product/464" target="_self">12in Chemical eTape Liquid Level Sensor</a></li>
<li> <a href="https://www.adafruit.com/product/4663" target="_self">Mini solenoid air valve</a></li>
<li> <a href="https://www.adafruit.com/product/2935" target="_self">Controllable Four Outlet Power Relay Module version 2</a></li>
<li> Separate 5v 1.5A power supply for solenoid and connectors to</li> 
<li> <a href="https://www.sunsethydro.com/collections/growing-media/products/grodan-delta-hugo-6in-block-6in-x-6in-x-6in-w-hole-individual-single-blocks" target="_self">growing media</a></li>
<li> <a href="https://www.truevalue.com/latch-carry-tote-clear-base-18-gallons" target="_self">totes</a></li>
<li> <a href="https://www.digikey.com/product-detail/en/nxp-usa-inc/MPVZ5004GW7U/MPVZ5004GW7U-ND/1168374" target="_self">MPVZ5004GW PRESSURE SENSOR by NXP</a></li>
<li> Silicone tubing</li>
</ul>

<b>Notes:</b>

<ul>
<li> <a href="https://learn.adafruit.com/home-automation-in-the-cloud-with-the-esp8266-and-adafruit-io/introduction" target="_self"><tt>https://learn.adafruit.com/home-automation-in-the-cloud-with-the-esp8266-and-adafruit-io/introduction</tt></a></li>
<li> Needs some type of anchoring for media in top container for replacing plants and rock wool easily</li>
<li> Flood chamber must be securely anchored against flotation</li>
<li> <a href="./PlantWaterer/PlantWaterer.html" target="_self">First iteration</a> of the design was a simple Trinket-based timer that controlled a <a href="https://www.adafruit.com/product/1150" target="_self">mini peristaltic pump</a>. It worked if the water source was elevated to deal with the limits of the pump curve.</li>
</ul>

<b>Logic:</b>

<ol>
<li> Server scheduling:

<ol type="a"></li>
   <li> Repeat Daily:</li>

<ol>
       <li> Fire client event</li>
       <li> If no completion signal in 60 minutes, report</li>
</ol>

</ol>

<li> Client event:

<ol type="a"></li>
   <li> turn on air pump and close air release valve for until level has stabilized to within 0.25" for 5 minutes</li>

<ol>
       <li> Report time to complete</li>
       <li> Repeat every 15 seconds: 

<ol type="a"></li>
           <li> report solution level from both sensors</li>
           <li> if it has been more than 20 minutes, terminate on cycle and alert</li>
</ol>

</ol>

   <li> if sensors do not agree on level, alert</li>
   <li> if solution level falls below 3", alert</li>
</ol>

</ol>

<b>CODE:</b>
<p>

<!-- code=c (!bc cpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #3D7B7B; font-style: italic">/***************************************************</span>
<span style="color: #3D7B7B; font-style: italic">  Adapted primarily from:</span>
<span style="color: #3D7B7B; font-style: italic">  Adafruit ESP8266 onoffbutton Controller Module</span>

<span style="color: #3D7B7B; font-style: italic">  Must use ESP8266 Arduino from:</span>
<span style="color: #3D7B7B; font-style: italic">    https://github.com/esp8266/Arduino</span>
<span style="color: #3D7B7B; font-style: italic">  Works great with Adafruit&#39;s Huzzah ESP board:</span>
<span style="color: #3D7B7B; font-style: italic">  ----&gt; https://www.adafruit.com/product/2471</span>
<span style="color: #3D7B7B; font-style: italic">  Adafruit invests time and resources providing this open source code,</span>
<span style="color: #3D7B7B; font-style: italic">  please support Adafruit and open-source hardware by purchasing</span>
<span style="color: #3D7B7B; font-style: italic">  products from Adafruit!</span>
<span style="color: #3D7B7B; font-style: italic">  Written by Tony DiCola for Adafruit Industries.</span>
<span style="color: #3D7B7B; font-style: italic">  Adafruit IO example additions by Todd Treece.</span>
<span style="color: #3D7B7B; font-style: italic">  MIT license, all text above must be included in any redistribution</span>
<span style="color: #3D7B7B; font-style: italic"> ****************************************************/</span><span style="color: #bbbbbb"></span>

<span style="color: #9C6500">#include</span><span style="color: #bbbbbb"> </span><span style="color: #3D7B7B; font-style: italic">&lt;WiFi101.h&gt; // for Feather M0 ATWINC1500</span><span style="color: #9C6500"></span>
<span style="color: #3D7B7B; font-style: italic">//#include &lt;WiFi.h&gt; // for Feather HUZZAH32 ESP32</span>
<span style="color: #3D7B7B; font-style: italic">//#include &lt;ESP8266WiFi.h&gt;</span>
<span style="color: #9C6500">#include</span><span style="color: #bbbbbb"> </span><span style="color: #3D7B7B; font-style: italic">&quot;Adafruit_MQTT.h&quot;</span><span style="color: #9C6500"></span>
<span style="color: #9C6500">#include</span><span style="color: #bbbbbb"> </span><span style="color: #3D7B7B; font-style: italic">&quot;Adafruit_MQTT_Client.h&quot;</span><span style="color: #9C6500"></span>
<span style="color: #9C6500">#include</span><span style="color: #bbbbbb"> </span><span style="color: #3D7B7B; font-style: italic">&quot;keysandstuff.h&quot;</span><span style="color: #9C6500"></span>


<span style="color: #3D7B7B; font-style: italic">// onoffbutton pin</span>
<span style="color: #008000; font-weight: bold">const</span><span style="color: #bbbbbb"> </span><span style="color: #B00040">int</span><span style="color: #bbbbbb"> </span>switch_pin<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span><span style="color: #666666">0</span>;<span style="color: #bbbbbb"></span>

<span style="color: #3D7B7B; font-style: italic">// Functions</span>
<span style="color: #3D7B7B; font-style: italic">//void MQTT_connect();</span>

WiFiClient<span style="color: #bbbbbb"> </span>client;<span style="color: #bbbbbb"></span>

<span style="color: #3D7B7B; font-style: italic">// Setup the MQTT client class by passing in the WiFi client and MQTT server and login details.</span>
Adafruit_MQTT_Client<span style="color: #bbbbbb"> </span><span style="color: #0000FF">mqtt</span>(<span style="color: #666666">&amp;</span>client,<span style="color: #bbbbbb"> </span>AIO_SERVER,<span style="color: #bbbbbb"> </span>AIO_SERVERPORT,<span style="color: #bbbbbb"> </span>AIO_USERNAME,<span style="color: #bbbbbb"> </span>AIO_KEY);<span style="color: #bbbbbb"></span>

<span style="color: #3D7B7B; font-style: italic">/****************************** Feeds ***************************************/</span><span style="color: #bbbbbb"></span>

<span style="color: #3D7B7B; font-style: italic">// Setup a feed called &#39;onoffbutton&#39; for subscribing to changes.</span>
<span style="color: #3D7B7B; font-style: italic">// Notice MQTT paths for AIO follow the form: &lt;username&gt;/feeds/&lt;feedname&gt;</span>
Adafruit_MQTT_Subscribe<span style="color: #bbbbbb"> </span>onoffbutton<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>Adafruit_MQTT_Subscribe(<span style="color: #666666">&amp;</span>mqtt,<span style="color: #bbbbbb"> </span>AIO_USERNAME<span style="color: #bbbbbb"> </span><span style="color: #BA2121">&quot;/feeds/onoff&quot;</span>);<span style="color: #bbbbbb"></span>
Adafruit_MQTT_Publish<span style="color: #bbbbbb"> </span>onoff_get<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>Adafruit_MQTT_Publish(<span style="color: #666666">&amp;</span>mqtt,<span style="color: #bbbbbb"> </span>AIO_USERNAME<span style="color: #bbbbbb"> </span><span style="color: #BA2121">&quot;/feeds/onoff/get&quot;</span>);<span style="color: #bbbbbb"></span>

<span style="color: #3D7B7B; font-style: italic">// Setup feeds for sensors</span>
Adafruit_MQTT_Publish<span style="color: #bbbbbb"> </span>level_Pressure<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>Adafruit_MQTT_Publish(<span style="color: #666666">&amp;</span>mqtt,<span style="color: #bbbbbb"> </span>AIO_USERNAME<span style="color: #bbbbbb"> </span><span style="color: #BA2121">&quot;/feeds/level_pressure&quot;</span>);<span style="color: #bbbbbb"></span>
Adafruit_MQTT_Publish<span style="color: #bbbbbb"> </span>level_Tape<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>Adafruit_MQTT_Publish(<span style="color: #666666">&amp;</span>mqtt,<span style="color: #bbbbbb"> </span>AIO_USERNAME<span style="color: #bbbbbb"> </span><span style="color: #BA2121">&quot;/feeds/level_tape&quot;</span>);<span style="color: #bbbbbb"></span>

<span style="color: #3D7B7B; font-style: italic">/*************************** Sketch Code ************************************/</span><span style="color: #bbbbbb"></span>

<span style="color: #B00040">void</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">setup</span>()<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">//Configure pins for Adafruit ATWINC1500 Feather</span>
<span style="color: #bbbbbb">  </span>WiFi.setPins(<span style="color: #666666">8</span>,<span style="color: #666666">7</span>,<span style="color: #666666">4</span>,<span style="color: #666666">2</span>);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>
<span style="color: #bbbbbb">  </span>pinMode(switch_pin,<span style="color: #bbbbbb"> </span>OUTPUT);<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span>Serial.begin(<span style="color: #666666">115200</span>);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">while</span><span style="color: #bbbbbb"> </span>(<span style="color: #666666">!</span>Serial)<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"> </span>;<span style="color: #bbbbbb"> </span>}<span style="color: #bbbbbb"> </span><span style="color: #3D7B7B; font-style: italic">// wait for serial port to connect. Needed for debugging with serial monitor only</span>
<span style="color: #bbbbbb">  </span>
<span style="color: #bbbbbb">  </span>delay(<span style="color: #666666">10</span>);<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">// Connect to WiFi access point.</span>
<span style="color: #bbbbbb">  </span>Serial.println();<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>Serial.println();<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span>Serial.print(<span style="color: #BA2121">&quot;Connecting to &quot;</span>);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>Serial.println(WLAN_SSID);<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span>WiFi.begin(WLAN_SSID,<span style="color: #bbbbbb"> </span>WLAN_PASS);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">while</span><span style="color: #bbbbbb"> </span>(WiFi.status()<span style="color: #bbbbbb"> </span><span style="color: #666666">!=</span><span style="color: #bbbbbb"> </span>WL_CONNECTED)<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>delay(<span style="color: #666666">500</span>);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>Serial.print(F(<span style="color: #BA2121">&quot;.&quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>}<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>Serial.println();<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span>Serial.println(F(<span style="color: #BA2121">&quot;WiFi connected&quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>Serial.println(F(<span style="color: #BA2121">&quot;IP address: &quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>Serial.println(WiFi.localIP());<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">// listen for events on the onoffbutton feed</span>
<span style="color: #bbbbbb">  </span>mqtt.subscribe(<span style="color: #666666">&amp;</span>onoffbutton);<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">// connect to adafruit io</span>
<span style="color: #bbbbbb">  </span>MQTT_connect();<span style="color: #bbbbbb"></span>

}<span style="color: #bbbbbb"></span>

<span style="color: #B00040">void</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">loop</span>()<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span><span style="color: #B00040">int8_t</span><span style="color: #bbbbbb"> </span>jobDuration;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>Adafruit_MQTT_Subscribe<span style="color: #bbbbbb"> </span><span style="color: #666666">*</span>subscription;<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">// ping adafruit io a few times to make sure we remain connected</span>
<span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">if</span>(<span style="color: #666666">!</span><span style="color: #bbbbbb"> </span>mqtt.ping(<span style="color: #666666">3</span>))<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #3D7B7B; font-style: italic">// reconnect to adafruit io</span>
<span style="color: #bbbbbb">    </span><span style="color: #008000; font-weight: bold">if</span>(<span style="color: #666666">!</span><span style="color: #bbbbbb"> </span>mqtt.connected())<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span>MQTT_connect();<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>}<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">//</span>
<span style="color: #bbbbbb">  </span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">// this is our &#39;wait for incoming subscription packets&#39; busy subloop</span>

<span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">while</span><span style="color: #bbbbbb"> </span>(subscription<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>mqtt.readSubscription(<span style="color: #666666">1000</span>))<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">    </span><span style="color: #008000; font-weight: bold">if</span><span style="color: #bbbbbb"> </span>(subscription<span style="color: #bbbbbb"> </span><span style="color: #666666">==</span><span style="color: #bbbbbb"> </span><span style="color: #666666">&amp;</span>onoffbutton)<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span>Serial.print(F(<span style="color: #BA2121">&quot;On-Off button: &quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span>Serial.println((<span style="color: #B00040">char</span><span style="color: #bbbbbb"> </span><span style="color: #666666">*</span>)onoffbutton.lastread);<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">      </span><span style="color: #3D7B7B; font-style: italic">// convert mqtt ascii payload to int</span>
<span style="color: #bbbbbb">      </span><span style="color: #B00040">char</span><span style="color: #bbbbbb"> </span><span style="color: #666666">*</span>value<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>(<span style="color: #B00040">char</span><span style="color: #bbbbbb"> </span><span style="color: #666666">*</span>)onoffbutton.lastread;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span>Serial.print(F(<span style="color: #BA2121">&quot;Received: &quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span>Serial.println(value);<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">      </span><span style="color: #3D7B7B; font-style: italic">// Apply message to onoffbutton</span>
<span style="color: #bbbbbb">      </span>String<span style="color: #bbbbbb"> </span>message<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>String(value);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span>message.trim();<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span><span style="color: #008000; font-weight: bold">if</span><span style="color: #bbbbbb"> </span>(message<span style="color: #bbbbbb"> </span><span style="color: #666666">==</span><span style="color: #bbbbbb"> </span><span style="color: #BA2121">&quot;ON&quot;</span>)<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>jobDuration<span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>Flood();<span style="color: #bbbbbb">      </span>
<span style="color: #bbbbbb">        </span>Serial.println(<span style="color: #BA2121">&quot;publishing to /get&quot;</span>);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>onoff_get.publish((<span style="color: #B00040">int32_t</span>)jobDuration);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span><span style="color: #008000; font-weight: bold">break</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span>}<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>}<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>}<span style="color: #bbbbbb"></span>
}<span style="color: #bbbbbb"></span>

<span style="color: #3D7B7B; font-style: italic">// connect to adafruit io via MQTT</span>

<span style="color: #B00040">void</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">MQTT_connect</span>()<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span><span style="color: #B00040">int8_t</span><span style="color: #bbbbbb"> </span>ret;<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">while</span><span style="color: #bbbbbb"> </span>((ret<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>mqtt.connect())<span style="color: #bbbbbb"> </span><span style="color: #666666">!=</span><span style="color: #bbbbbb"> </span><span style="color: #666666">0</span>)<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">    </span><span style="color: #008000; font-weight: bold">switch</span><span style="color: #bbbbbb"> </span>(ret)<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span><span style="color: #008000; font-weight: bold">case</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1:</span><span style="color: #bbbbbb"> </span>Serial.println(F(<span style="color: #BA2121">&quot;Wrong protocol&quot;</span>));<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">break</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span><span style="color: #008000; font-weight: bold">case</span><span style="color: #bbbbbb"> </span><span style="color: #666666">2:</span><span style="color: #bbbbbb"> </span>Serial.println(F(<span style="color: #BA2121">&quot;ID rejected&quot;</span>));<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">break</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span><span style="color: #008000; font-weight: bold">case</span><span style="color: #bbbbbb"> </span><span style="color: #666666">3:</span><span style="color: #bbbbbb"> </span>Serial.println(F(<span style="color: #BA2121">&quot;Server unavail&quot;</span>));<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">break</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span><span style="color: #008000; font-weight: bold">case</span><span style="color: #bbbbbb"> </span><span style="color: #666666">4:</span><span style="color: #bbbbbb"> </span>Serial.println(F(<span style="color: #BA2121">&quot;Bad user/pass&quot;</span>));<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">break</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span><span style="color: #008000; font-weight: bold">case</span><span style="color: #bbbbbb"> </span><span style="color: #666666">5:</span><span style="color: #bbbbbb"> </span>Serial.println(F(<span style="color: #BA2121">&quot;Not authed&quot;</span>));<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">break</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span><span style="color: #008000; font-weight: bold">case</span><span style="color: #bbbbbb"> </span><span style="color: #666666">6:</span><span style="color: #bbbbbb"> </span>Serial.println(F(<span style="color: #BA2121">&quot;Failed to subscribe&quot;</span>));<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">break</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span><span style="color: #008000; font-weight: bold">default</span><span style="color: #666666">:</span><span style="color: #bbbbbb"> </span>Serial.println(F(<span style="color: #BA2121">&quot;Connection failed&quot;</span>));<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">break</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>}<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">    </span><span style="color: #008000; font-weight: bold">if</span>(ret<span style="color: #bbbbbb"> </span><span style="color: #666666">&gt;=</span><span style="color: #bbbbbb"> </span><span style="color: #666666">0</span>)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">      </span>mqtt.disconnect();<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">    </span>Serial.println(F(<span style="color: #BA2121">&quot;Retrying MQTT connection in 5 seconds...&quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>delay(<span style="color: #666666">5000</span>);<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span>}<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>Serial.println(F(<span style="color: #BA2121">&quot;MQTT Connected to Adafruit IO!&quot;</span>));<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">/*</span>
<span style="color: #3D7B7B; font-style: italic">  Publishing to {username}/feeds/onoff/get will trigger the last</span>
<span style="color: #3D7B7B; font-style: italic">  value to be resent. Putting this call inside the MQTT_connect</span>
<span style="color: #3D7B7B; font-style: italic">  function means that whenever MQTT reconnects, the latest value</span>
<span style="color: #3D7B7B; font-style: italic">  for the feed will be received almost immediately.</span>
<span style="color: #3D7B7B; font-style: italic">  */</span><span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>Serial.println(<span style="color: #BA2121">&quot;publishing to /get&quot;</span>);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">  </span>onoff_get.publish((<span style="color: #B00040">int32_t</span>)<span style="color: #666666">0</span>);<span style="color: #bbbbbb"></span>
}<span style="color: #bbbbbb"></span>

<span style="color: #B00040">int8_t</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">Flood</span>()<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #B00040">int</span><span style="color: #bbbbbb"> </span>timer<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span><span style="color: #666666">0</span>;<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">    </span><span style="color: #3D7B7B; font-style: italic">// turn on air pump and close ARV</span>
<span style="color: #bbbbbb">    </span>digitalWrite(switch_pin,<span style="color: #bbbbbb"> </span>LOW);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>
<span style="color: #bbbbbb">    </span><span style="color: #B00040">float</span><span style="color: #bbbbbb"> </span>level_pressure_data;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #B00040">float</span><span style="color: #bbbbbb"> </span>level_tape_data;<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">    </span><span style="color: #B00040">float</span><span style="color: #bbbbbb"> </span>last_level_pressure_data<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span><span style="color: #666666">0</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #B00040">float</span><span style="color: #bbbbbb"> </span>last_level_tape_data<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span><span style="color: #666666">0</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #008000; font-weight: bold">while</span><span style="color: #bbbbbb"> </span>(<span style="color: #008000">true</span>)<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>timer<span style="color: #bbbbbb"> </span><span style="color: #666666">+=</span><span style="color: #bbbbbb"> </span><span style="color: #666666">3</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>level_pressure_data<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span><span style="color: #666666">0</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>level_tape_data<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span><span style="color: #666666">0</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span><span style="color: #008000; font-weight: bold">if</span><span style="color: #bbbbbb"> </span>(<span style="color: #666666">!</span><span style="color: #bbbbbb"> </span>level_Pressure.publish(level_pressure_data))<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">          </span>Serial.println(F(<span style="color: #BA2121">&quot;Failed to publish level_pressure&quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span><span style="color: #008000; font-weight: bold">else</span><span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">          </span>Serial.println(F(<span style="color: #BA2121">&quot;Level_pressure published!&quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">         </span>
<span style="color: #bbbbbb">        </span><span style="color: #008000; font-weight: bold">if</span><span style="color: #bbbbbb"> </span>(<span style="color: #666666">!</span><span style="color: #bbbbbb"> </span>level_Tape.publish(level_tape_data))<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">          </span>Serial.println(F(<span style="color: #BA2121">&quot;Failed to publish level_tape&quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span><span style="color: #008000; font-weight: bold">else</span><span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">          </span>Serial.println(F(<span style="color: #BA2121">&quot;Level_tape published!&quot;</span>));<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>
<span style="color: #bbbbbb">        </span>last_level_pressure_data<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>level_pressure_data;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>last_level_tape_data<span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span>level_tape_data;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>
<span style="color: #bbbbbb">        </span><span style="color: #008000; font-weight: bold">if</span><span style="color: #bbbbbb"> </span>(abs(level_pressure_data<span style="color: #bbbbbb"> </span><span style="color: #666666">-</span><span style="color: #bbbbbb"> </span>level_tape_data)<span style="color: #bbbbbb"> </span><span style="color: #666666">&gt;</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1</span>)<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">            </span><span style="color: #3D7B7B; font-style: italic">//send alert</span>
<span style="color: #bbbbbb">        </span>}<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span><span style="color: #008000; font-weight: bold">if</span><span style="color: #bbbbbb"> </span>((level_pressure_data<span style="color: #bbbbbb"> </span><span style="color: #666666">&lt;</span><span style="color: #bbbbbb"> </span><span style="color: #666666">3</span>)<span style="color: #bbbbbb"> </span><span style="color: #666666">||</span><span style="color: #bbbbbb"> </span>(level_tape_data<span style="color: #bbbbbb"> </span><span style="color: #666666">&lt;</span><span style="color: #bbbbbb"> </span><span style="color: #666666">3</span>)){<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">            </span><span style="color: #3D7B7B; font-style: italic">//send alert</span>
<span style="color: #bbbbbb">        </span>}<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span><span style="color: #008000; font-weight: bold">if</span><span style="color: #bbbbbb"> </span>(timer<span style="color: #bbbbbb"> </span><span style="color: #666666">&gt;</span><span style="color: #bbbbbb"> </span><span style="color: #666666">20</span>)<span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">            </span><span style="color: #3D7B7B; font-style: italic">//send alert</span>
<span style="color: #bbbbbb">            </span>digitalWrite(switch_pin,<span style="color: #bbbbbb"> </span>HIGH);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">            </span><span style="color: #008000; font-weight: bold">break</span>;<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>}<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>delay(<span style="color: #666666">3000</span>);<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>}<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #008000; font-weight: bold">return</span><span style="color: #bbbbbb"> </span>timer;<span style="color: #bbbbbb"></span>
}<span style="color: #bbbbbb"></span>
</pre></div>
<p>
<!-- !split -->

<h1 id="___sec17">Technology as Art </h1>

<h2 id="___sec18">Wood Burning Plotter </h2>
<b>Description:</b>
A polar coordinate-based dual axis large-format plotter that uses solar power to maneuver a magnifying
lens over a wooden canvas vertically to burn an image.

<p>
<b>User Story:</b>
Plotters are simple output devices, but can require a large amount of track and
infrastructure; using 2 motors to control location of marker via line in/out in a polar coordinate
fashion will allow the device to scale up to billboard size for a giant art display, say along a
major north/south interstate highway. For example.

<p>
<b>Feature Set:</b>

<ol>
<li> Weatherproof and hidden controller, motor, and spindle housing</li>
<li> Solar-powered</li>
<li> Spool capacity of 50' of 30# braided fishing line</li>
<li> Spooling speed control from 1mm/min - 25mm/min</li>
<li> Optical sensor for darkness of burn</li>
<li> Removable controller, for image and software update</li>
<li> Calibration process</li>
<li> Fire suppression</li>
</ol>

<b>Notes:</b>

<ol>
<li> <a href="https://www.raspberrypi.org/blog/we-love-a-good-pen-plotter/" target="_self"><tt>https://www.raspberrypi.org/blog/we-love-a-good-pen-plotter/</tt></a></li>
</ol>

<b>Phasing:</b>

<p>
<b>BOM:</b>

<h2 id="___sec19">Lightning Catcher </h2>
<b>Description:</b>
Rocket-based micro-wire launch system to direct a lightning strike to a specific location

<p>
<b>User Story:</b>
Lightning is one of the most powerful forces of nature, and I want to catch it. Plus, it could be a great learning opportunity.

<p>
<b>Feature Set:</b>

<ol>
<li> Fully enclosed silo system</li>
<li> Internet or phone activated</li>
<li> Hi-speed photography?</li>
<li> 2000m altitude</li>
</ol>

<b>Phasing:</b>

<ul>
<li> Research where/how this has been done before</li>
<li> Find a wide-open enough area that someone will allow this to happen in</li>
<li> Build launch system in test silo</li>
<li> Test launch</li>
<li> Install silo</li>
<li> Track weather</li>
</ul>

<!-- !split -->

<h1 id="___sec20">Irrigation Remote </h1>
<b>Description:</b>
Simple SCADA to drive drip irrigation.

<p>
<b>User Story:</b>
We leave the house for extended periods during hot dry weather and know that we won't lose plants. When we harvest, we can turn off drippers by plant. Plumbing and electrical are unobtrusive and dependable. Water is conserved as much as possible. We can use rain water if desired.

<p>
<b>Feature Set:</b>

<ol>
<li> Main line valves actuated by internet-connected IoT switch, on schedule with manual overrides.</li>
<li> Flow meter used to activate alarm of valve failure and fine-tune water usage.</li>
<li> Rain, soil moisture, and localized temperature sensor pack to fine-tune water usage. Battery-powered and internet-connected for minimal wiring.</li>
<li> Gang valving and individual drippers in garden for easy access and fine control.</li>
<li> Main line plumbing hidden and removable for storage, freeze protection, repair, and protection.</li>
<li> SImple set up and, logging, and dashobarding via <a href="https://learn.adafruit.com/quickstart-adafruit-io-wippersnapper" target="_self">WipperSnapper</a></li>
</ol>

<b>Phasing:</b>

<ul>
<li> indoor plumbing to hose cock (done)</li>
<li> cistern with submersible pump (done)</li>
<li> IoT switch, meter, and main line valve (done)</li>
<li> buried main line and gang valving</li>
<li> Soil moisture and flow sensors</li>
</ul>

<b>BOM:</b>

<ol>
<li> "https://www.adafruit.com/wishlists?wid=554909"</li>
</ol>

<center> <!-- figure label: --> <div id="fig:plumbing"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 3:  Plumbing Schematic.  <!-- caption label: fig:plumbing --> </p></center>
<p><img src="HappyHippieLifestyle/plumbing.png" align="bottom" width=900></p>
</center>

<p>
<!-- !split -->

<h1 id="___sec21">The Best Damn Radio System </h1>

<p>
<b>Description:</b>
Tiny HAM radio that can be used anywhere

<p>
<b>User Story:</b>
The world is still a big place and to explore certain parts in safety, we need a way to broadcast an emergency.
PLBS are really only domestic, not hackable (or even able to replace batteries), and for emergency only. Sat messengers have
not-insignificant subscription fees, and varying coverage. HAM remains the most ubiquitous global radio infrastructure, and with
help, can be transmitted from any global location, for a variety of needs.

<p>
<b>Feature Set:</b>

<ol>
<li> Handheld SDR</li>
<li> Uses APRS+GPS for tracking mode</li>
<li> Can be modded to suit the locale and needs of a trip</li>
<li> Can be used for personal emergency messaging, way-point tacking, sharing progress</li>
<li> Ruggedize by potting in epoxy with heat sinks?</li>
<li> Cheap and small enough to carry spares</li>
<li> Yagi antenna to use as a directional beacon?</li>
</ol>

<b>Notes:</b>

<ul>
<li> Reference devices:</li>

<ul>
    <li> <a href="https://www.byonics.com/tinytrak4" target="_self">Tiny tracker</a></li>
    <li> <a href="https://www.garmin.com/en-US/p/561269" target="_self">Inreach Explorer</a></li>
    <li> <a href="https://hackaday.io/project/1538-portablesdr" target="_self">PortableSDR on Hackaday</a></li>
    <li> <a href="https://www.adafruit.com/product/3583?gclid=CjwKCAiAsNKQBhAPEiwAB-I5zUZdGPTO1cpWq1uvHynsPHWheqFeQ6TxZsp3_P-s2Zo4jjYT4xDFMhoCwPQQAvD_BwE" target="_self">Great Scott base unit</a>
<!-- !split -->
<!-- ======= Template ======= -->
<!-- __Description:__ -->
<!-- __User Story:__ -->
<!-- __Feature Set:__ -->
<!-- o -->
<!-- __Phasing:__ -->
<!-- * -->
<!-- __BOM:__ -->
<!-- o -->
<!-- __Notes:__ -->
<!-- * -->
<!-- __Logic:__ -->
<!-- __Code:__ -->
<!-- @@@CODE ./filepath envir=Xpro -->
<!-- FIGURE: [path, width=900 frac=0.9] Something. <div id="fig:tag1"></div> --></li>
</ul>

</ul>

<!-- !split -->


<center><h1>Robotics Projects</h1></center>  <!-- document title -->

<h1 id="table_of_contents">Table of contents</h2>

<p>
<a href="#___sec0"> Robotics Club Setup </a><br>
<a href="#___sec1"> Home Internet Gateway </a><br>
<a href="#___sec2"> Arduino Wind Instrument </a><br>
<a href="#___sec3"> Motocomms </a><br>
<a href="#___sec4"> Track GDD </a><br>
<a href="#___sec5"> Tartan designer </a><br>
<a href="#___sec6"> Somerlot Shooting Support System (S4) </a><br>
<a href="#___sec7"> Retail support tools </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec8"> Scheduler </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec9"> Rewards Program Calculator </a><br>
<a href="#___sec10"> Homemade Variable Frequency Drive </a><br>
<a href="#___sec11"> Common Mobile Compute Platform </a><br>
<a href="#___sec12"> Domotics </a><br>
<a href="#___sec13"> Automotive Media System </a><br>
<a href="#___sec14"> GPS Chartplotter </a><br>
<a href="#___sec15"> Common Sensor and Datalogger Platform </a><br>
<a href="#___sec16"> Micro Hydroponics </a><br>
<a href="#___sec17"> Technology as Art </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec18"> Wood Burning Plotter </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec19"> Lightning Catcher </a><br>
<a href="#___sec20"> Irrigation Remote </a><br>
<a href="#___sec21"> The Best Damn Radio System </a><br>
<a href="#___sec22"> Fixed Wing UAV </a><br>
<a href="#___sec23"> Submersible / Surface ROV </a><br>
<a href="#___sec24"> Pool Octobot </a><br>
<a href="#___sec25"> Scarecrow Targeting System </a><br>
<a href="#___sec26"> Invasive Species Patroller </a><br>
<a href="#___sec27"> Signal-Tracking Antenna Mount </a><br>
</p>
<p>
Welcoming our new overlords...

<p>
<!-- !split -->

<h1 id="___sec22">Fixed Wing UAV </h1>
<b>Description:</b>
open-source, open-hardware driven custom fixed-wing UAV platform for efficient
mapping projects and long-distance linear asset inspection

<p>
<b>User Story:</b>
Quadcopter UAVs are great for inspections and tight places, but require many
batteries and many flights to capture site imagery used for mapping. They are also expensive and difficult to control. With so many camera and sensor options available off-the-shelf, a fixed-wing platform like the eBee makes a lot of sense for certain types of missions.

<p>
<b>Feature Set:</b>

<ol>
<li> 500 gram payload</li>
<li> Assisted take-off</li>
<li> Automated flights</li>
</ol>

<!-- !split -->

<h1 id="___sec23">Submersible / Surface ROV </h1>
<b>Description:</b>
A long-range, long-duration, aquatic robotic sensor platform for locating and investigating underwater interests

<p>
<b>User Story:</b>
Many things are down there in the deep, waiting discovery. Metal, habitat, species...
many things, in many places, some very remote. I want a platform that can travel the world with any sensor I can dream of, and deliver itself back to me.

<p>
<b>Feature Set:</b>

<ul>
<li> Surface capabilities:</li>

<ul>
    <li> Solar charging</li>
    <li> Navigation</li>

<ul>
        <li> Distance (proximity) sensors</li>
        <li> Surface GPS</li>
</ul>

    <li> Sonar scanning</li>
</ul>

<li> Subsurface capabilities:</li>

<ul>
    <li> Dives to 1000m, up to 72 hrs</li>
    <li> Imaging</li>

<ul>
        <li> Scheduled</li>
        <li> Event-driven</li>

<ul>
            <li> Sudden light change</li>
            <li> Proximity alert</li>
</ul>

        <li> 360-degree FOV</li>
        <li> Low-light</li>
        <li> Mission-based</li>

<ul>
            <li> Wrecks</li>
            <li> Reefs</li>
</ul>

</ul>

    <li> Metal detection</li>
    <li> Bathymetric scans</li>
    <li> Evasion</li>
</ul>

<li> Locomotion</li>

<ul>
    <li> Low-speed/power, mostly currents</li>
    <li> Impeller with vent clearing</li>
</ul>

<li> Communications/data link</li>

<ul>
    <li> ASPRS for global, daily logging of location, vital metrics</li>
    <li> On-demand wifi for debugging</li>
    <li> Low-power, long-range packet radio receiver for actuating beacons</li>
    <li> <a href="https://www.adafruit.com/product/4521" target="_self">Iridium sat comms</a></li>
</ul>

<li> Fail-safes:</li>

<ul>
    <li> Coordinate with round-the-world sailing orgs for manual recovery</li>
    <li> Emergency surfacing and diving</li>
    <li> Beacons (event-driven)</li>

<ul>
        <li> VHS</li>
        <li> Lights</li>
</ul>

    <li> Packet radio for near-shore communication</li>
    <li> 7-day reserve power</li>
    <li> Hibernation mode</li>
    <li> Warning labeling in many languages</li>
    <li> Claws for getting unstuck from tight places and fishing lines</li>
</ul>

</ul>

<b>Phasing:</b>

<ol>
<li> Build manual prototype with goPro</li>
<li> Sensors package development and testing</li>
<li> Upgrades for survivability and power reserve</li>
<li> Mission programming and data logging</li>
<li> 24 hr Otisco test</li>
<li> 30 day Ontario test</li>
<li> 180 day Gulf Stream mission (launch in Ft Pierce in Feb, recover in Iceland)</li>
<li> Re-engineer into a small remora-style package to find and attach to large animals</li>
</ol>

<b>BOM:</b>
1.

<p>
<b>Notes:</b>

<ul>
<li> <a href="https://www.raspberrypi.org/blog/fish-pi/" target="_self"><tt>https://www.raspberrypi.org/blog/fish-pi/</tt></a></li>
<li> <a href="http://cma.soton.ac.uk/research/black-sea-map/" target="_self"><tt>http://cma.soton.ac.uk/research/black-sea-map/</tt></a></li>
</ul>

<!-- !split -->

<h1 id="___sec24">Pool Octobot </h1>
<b>Description:</b>
a multi-armed, multi-sensored robot for cleaning pools

<p>
<b>User Story:</b>
Cleaning pools involves scrubbing algal growth from surfaces, and sucking up debris. What better format of robot to do this but something with 8 arms, a beak mouth, and a bag to hold debris?

<p>
<b>Feature Set:</b>

<ol>
<li> Color sensors for detecting growth, brushes for removing</li>
<li> Tactile sensors for objects and climbing, suction and/or jets for locomotion</li>
<li> Self-charging at remote dry dock</li>
<li> Expandable debris bag</li>
<li> Skin color changing - for fun. And camoflage</li>
</ol>

<b>Phasing:</b>

<ul>
<li> Research sensors</li>
</ul>

<!-- !split -->

<h1 id="___sec25">Scarecrow Targeting System </h1>
<b>Description:</b>
a camera-based object tracking software system

<p>
<b>User Story:</b>
In the suburban warfare environment, its our ability to grow food versus mother nature's ability to provide - gardens versus wildlife - me versus the creatures - fencing versus projectile-based discouragement. I want to defend my many hours of invested effort from the random and sneaky browsing of deer and dog.

<p>
<b>Feature Set:</b>

<ol>
<li> Intelligent and real-time image tracking during day or night, based on sample images</li>
<li> Housed in a scarecrow, with duplicate, stereo single-lens object trackers</li>
<li> Detection alarms - audible, visible, and internet</li>
<li> Directional actuator for firing projectiles, spray, flame, etc at the real-time coordinate of target</li>
<li> 90% accurate against false-falses, 75% accurate against false-positives</li>
<li> Video recording with target boxing</li>
<li> Web-served catalog of recordings</li>
<li> 130-degree FOV, 90-degree firing field</li>
<li> Time-lapse photography built-in</li>
</ol>

<b>Phasing:</b>

<ul>
<li> Software build of single-lens object tracker</li>
<li> Hardware build of multiple trackers</li>
<li> Build out of housing and alarms</li>
<li> UAT</li>
<li> Build out of targeting and firing</li>
</ul>

<b>BOM:</b>

<ul>
<li> RPi3 w/ Camera x 4</li>
</ul>

<!-- !split -->

<h1 id="___sec26">Invasive Species Patroller </h1>
<b>Description:</b>
An outdoor version of a roomba-like crawler than can identify and deal with a targeted invasive species

<p>
<!-- !split -->

<h1 id="___sec27">Signal-Tracking Antenna Mount </h1>

<p>
<b>Description:</b>
A mechanism to automate the pointing of recevier/transmitter sensors.

<p>
<b>User Story:</b>
If my awesome new FOS laser link at remote data IoT device can't communicate, its not nearly as useful.

<p>
<!-- !split -->
<!-- ======= Template ======= -->

<p>
<!-- __Description:__ -->
<!-- __User Story:__ -->
<!-- __Feature Set:__ -->
<!-- o -->

<p>
<!-- __Phasing:__ -->
<!-- * -->

<p>
<!-- __BOM:__ -->
<!-- o -->

<p>
<!-- __Notes:__ -->
<!-- * -->

<p>
<!-- __Code:__ -->
<!-- @@@CODE ./filepath envir=Xpro -->

<p>
<!-- FIGURE: [path, width=900 frac=0.9] Something. <div id="fig:tag"></div> -->

<!-- ------------------- end of main content --------------- -->


<center style="font-size:80%">
<!-- copyright -->  Made with <a href="https://github.com/hplgit/doconce">DocOnce</a>
</center>


</body>
</html>
    

